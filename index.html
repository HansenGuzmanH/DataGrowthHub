<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hansen | Data Growth Hub</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@900&display=swap" rel="stylesheet">

    <!-- Librerías JS (en el head para asegurar la carga) -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    
    <style>
        :root {
            --color-background: #222831; 
            --color-text: #f0f0f0;
            --color-primary: #14b8a6; /* Teal vibrante */
            --color-secondary: #FC5185; /* Rosa neón (updated) */
            --font-title: 'Montserrat', sans-serif;
            --font-body: 'Inter', sans-serif;
            --menu-width: 50vw;
            --menu-max-width: 600px;
            --header-height: 70px; 
            --corner-radius: 15px;
            --color-border: rgba(255, 255, 255, 0.1); 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: auto; }
        body {
            font-family: var(--font-title);
            background-color: var(--color-background);
            color: var(--color-text);
            overflow-x: hidden;
        }

        /* ----- Header y Menú Lateral (ACTUALIZADO) ----- */
        .main-header {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 1800px; 
            border-radius: var(--corner-radius);
            background-color: rgba(26, 29, 35, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px); 
            border: 1px solid var(--color-border);
            height: var(--header-height);
            display: flex;
            justify-content: space-between; /* Adjusted for better spacing */
            align-items: center;
            padding: 0 30px; /* Increased padding for overall header spacing */
            z-index: 1000;
            transition: top 0.3s ease, background-color 0.3s ease; 
            overflow: hidden; /* Ensure anything overflowing the main-header is clipped */
            position: relative; /* Needed for z-index context of children */
        }
        
        /* MODIFICACIÓN: Nuevo estilo para el fondo gráfico del encabezado */
        .header-graph-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Coloca el SVG detrás de los elementos del encabezado */
            overflow: hidden; /* Asegura que el SVG no se desborde del fondo del encabezado */
        }

        .header-graph-background svg {
            width: 120%; /* Make it slightly wider to allow for movement */
            height: 100%;
            transform: translateX(0);
            animation: graph-scroll 15s linear infinite; /* Subtle continuous movement */
        }

        @keyframes graph-scroll {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-20%); } /* Move slightly left */
        }

        .header-graph-background path {
            stroke: var(--color-secondary);
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke-opacity: 0.6; /* Adjust transparency here */
        }

        .header-section { display: flex; align-items: center; }
        .header-section.left { flex: 0 0 auto; justify-content: flex-start; } 
        .header-section.center { flex: 1 1 auto; justify-content: center; text-align: center; } 
        .header-section.right { 
            flex: 0 0 auto; /* Allow content to define size, but prevent shrinking/growing too much */
            justify-content: flex-end; 
        } 
        
        .logo { 
            font-size: 1.6rem; 
            text-decoration: none; 
            font-weight: 900; 
            font-family: var(--font-title);
            white-space: nowrap;
        }
        
        .animated-gradient-text {
            background: linear-gradient(90deg, #EEEEEE, #00ADB5, #EEEEEE);
            background-size: 200% auto;
            color: #fff;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-flow 4s ease infinite;
        }

        @keyframes gradient-flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .header-controls { display: flex; align-items: center; gap: 1rem; }
        .linkedin-icon { color: white; transition: color 0.3s ease, transform 0.3s ease; }
        .linkedin-icon:hover { color: var(--color-primary); transform: scale(1.1); }
        .linkedin-icon svg { width: 32px; height: 32px; }
        
        .header-icon {
            height: 55px; /* Altura fija para el contenedor del icono */
            width: auto; /* Ancho automático para permitir que la imagen defina su ancho */
            border-radius: 0;
            transition: transform 0.3s ease;
            display: flex; /* Permite centrar la imagen dentro si es necesario */
            align-items: center;
            justify-content: center;
        }
        .header-icon img {
            height: 100%; /* La imagen ocupa el 100% de la altura de su contenedor */
            width: auto; /* El ancho se ajusta automáticamente para mantener la proporción */
            object-fit: contain; /* Mantiene la proporción de la imagen dentro del espacio disponible */
            max-width: none; /* Asegura que no haya un max-width que la comprima globalmente */
        }
        .header-icon:hover { transform: scale(1.1); }

        .menu-trigger { background: none; border: none; cursor: pointer; z-index: 1002; padding: 10px; transition: transform 0.3s ease; }
        .menu-trigger:hover { transform: scale(1.1); }

        .hamburger-icon { width: 34px; height: 28px; display: flex; flex-direction: column; justify-content: space-between; }
        .line { width: 100%; height: 3px; background-color: white; transition: all 0.3s ease-in-out; }
        .menu-trigger.is-active .line-1 { transform: rotate(45deg) translate(8px, 8px); }
        .menu-trigger.is-active .line-2 { opacity: 0; }
        .menu-trigger.is-active .line-3 { transform: rotate(-45deg) translate(8px, -8px); }
        
        .menu-overlay { 
            position: fixed; top: 0; left: 0; 
            width: min(var(--menu-width), var(--menu-max-width)); 
            height: 100%; 
            background-color: rgba(34, 40, 49, 0.9);
            backdrop-filter: blur(20px); 
            z-index: 1001; 
            display: flex; flex-direction: column; justify-content: center;
            transform: translateX(-100%); visibility: hidden; 
            transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1), visibility 0.6s; 
        }
        .menu-overlay.is-open { transform: translateX(0); visibility: visible; }
        .menu-close-btn { position: absolute; top: 1.5rem; right: 5%; background: none; border: none; cursor: pointer; color: white; padding: 10px; transition: transform 0.4s ease; }
        .menu-close-btn:hover { transform: rotate(90deg); color: var(--color-primary); }
        .menu-close-btn svg { width: 32px; height: 32px; }
        .overlay-nav {
            list-style: none; text-align: left; padding-left: 10%; width: 100%; flex-grow: 1;
            display: flex; flex-direction: column; justify-content: flex-start; 
            padding-top: 20vh;
        }
        .overlay-nav li { margin: 1.2rem 0; transform: translateX(-20px); opacity: 0; transition: transform 0.4s ease, opacity 0.4s ease; }
        .menu-overlay.is-open .overlay-nav li { transform: translateX(0); opacity: 1; }
        .menu-overlay.is-open .overlay-nav li:nth-child(1) { transition-delay: 0.15s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(2) { transition-delay: 0.20s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(3) { transition-delay: 0.25s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(4) { transition-delay: 0.30s; }
        .overlay-nav a {
            color: white; text-decoration: none; font-size: clamp(1.4rem, 3.5vw, 1.8rem);
            font-family: var(--font-title); font-weight: 700; text-transform: uppercase;
            transition: color 0.3s ease; overflow-wrap: break-word;
        }
        .overlay-nav a:hover { color: var(--color-primary); }
        
        .menu-footer-icon {
            padding: 2rem 0;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .menu-footer-icon .linkedin-icon svg { width: 48px; height: 48px; }

        /* ----- Contenido Principal y Secciones ----- */
        main { position: relative; z-index: 1; }
        h1, h2, h3, h4, h5, h6 { 
            font-family: var(--font-title); 
            text-transform: uppercase; 
            color: var(--color-text);
        }
        
        .sequence-container { position: relative; height: 100vh; }
        .sticky-element { height: 100%; width: 100%; overflow: hidden; }
        .sequence-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        
        .background-image { 
            background: radial-gradient(ellipse at center, #393E46, #222831);
            position: relative; overflow: hidden; 
        }
        
        .background-image::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(110deg, transparent 40%, rgba(255, 255, 255, 0.15) 50%, transparent 60%);
            background-size: 200% 100%; background-repeat: no-repeat;
            animation: shine-effect 5s infinite linear;
        }

        @keyframes shine-effect {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .knockout-text-layer { 
            background-color: black; mix-blend-mode: screen; 
            display: flex; flex-direction: column; justify-content: flex-start;
            align-items: center; 
            padding-top: calc(var(--header-height) + 10px); /* Adjusted to bring "Data Growth" closer to header */
        }

        .title-container { text-align: left; }
        .title-container .top-row { display: flex; align-items: flex-end; }
        .title-container h1 { font-size: 15vw; line-height: 0.9; color: white; }
        .growth-arrow { 
            width: 30vw; 
            height: 20vw; 
            margin-left: 2vw; 
            opacity: 0.75; 
            overflow: visible; 
        }
        .growth-arrow path { stroke: #FF2E63; stroke-width: 12; stroke-linecap: round; stroke-linejoin: round; fill: none; }

        /* MODIFICACIÓN: Estilo para el span que contiene el logo como "O" - tamaño y posición ajustados */
        .growth-o-logo {
            display: inline-block;
            width: 0.8em; /* Agrandado un poco más */
            height: 0.8em; /* Agrandado un poco más */
            background-image: url('https://i.imgur.com/D7C6inO.png'); /* URL corregida */
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            vertical-align: middle; /* Alinea verticalmente con el texto */
            margin: 0 0.05em; /* Pequeño ajuste de margen horizontal */
            transform: translateY(-0.1em); /* Subido ligeramente */
        }

        .subtitle-wrapper { margin-top: 3vh; text-align: center; width: 90%; max-width: 600px; color: rgba(255, 255, 255, 0.9); }
        .subtitle-text {
            font-family: var(--font-body); font-size: clamp(1rem, 2.5vw, 1.2rem);
            line-height: 1.7; text-transform: none; font-weight: 400;
        }
        .subtitle-text a {
            color: var(--color-primary); font-weight: bold; text-decoration: none;
            background-image: linear-gradient(var(--color-primary), var(--color-primary));
            background-size: 0% 2px; background-repeat: no-repeat; background-position: left bottom;
            transition: background-size 0.3s ease;
        }
        .subtitle-text a:hover { background-size: 100% 2px; }

        .scroll-down-arrow {
            width: 35px; height: 35px; color: white; display: block; margin: 20px auto 0;
            animation: bounce-arrow 2.5s infinite cubic-bezier(0.68, -0.55, 0.27, 1.55); cursor: pointer;
        }

        @keyframes bounce-arrow {
            0%, 100% { transform: translateY(0); opacity: 0.8; }
            50% { transform: translateY(8px); opacity: 1; }
        }
        
        .outro-section { 
            padding: 15vh 5% 5vh; 
            text-align: center; 
            background-color: var(--color-background); 
            position: relative; 
            z-index: 2; 
            max-width: 100vw; /* Ensure no horizontal scroll */
            overflow-x: hidden; /* Hide any overflow */
        }
        .outro-section h2 {
            text-align: center; 
            font-size: clamp(3rem, 8vw, 6rem); 
            margin-bottom: 2rem; /* Reduced margin-bottom to bring text closer */
        }
        
        .gallery-container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        .gallery-header { max-width: 900px; margin: 0 auto 2rem auto; padding: 0 2rem; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 3rem; }
        .gallery-header p { font-family: var(--font-body); font-size: 1.1rem; color: #FFFFFF; line-height: 1.7; text-transform: none; }
        
        .gallery-main-image {
            width: 100%; height: 600px; margin-bottom: 1rem; background-color: #2a3038;
            border-radius: 15px; overflow: hidden; box-shadow: 0 15px 40px rgba(0,0,0,0.6); cursor: pointer;
        }
        .gallery-main-image img { width: 100%; height: 100%; object-fit: contain; transition: opacity 0.4s ease-in-out; }
        .gallery-thumbnails { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; }
        .gallery-thumbnail {
            width: 100%; aspect-ratio: 16 / 10; border-radius: 8px; cursor: pointer; overflow: hidden;
            border: 3px solid transparent; transition: border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease; opacity: 0.6;
        }
        .gallery-thumbnail:hover { transform: scale(1.05); opacity: 1; }
        .gallery-thumbnail.active { border-color: var(--color-primary); opacity: 1; }
        .gallery-thumbnail img { width: 100%; height: 100%; object-fit: cover; }
        
        .bi-text-container {
            font-family: var(--font-body); 
            text-align: left; 
            max-width: 1200px; 
            margin: 0 auto 2rem auto; 
            color: #e0e0e0; 
            line-height: 1.8; 
            padding: 0 2rem;
        }
        .bi-text-container p {
            font-family: var(--font-body); font-weight: 400; font-size: 1.15rem; color: #e0e0e0;
            line-height: 1.9; margin-bottom: 1.5rem; text-transform: none;
        }
        .bi-text-container p strong { color: var(--color-primary); }
        
        /* Estilos para el Lightbox de la Galería */
        .image-modal-overlay {
            position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center;
            animation: fadeIn 0.3s;
        }
        .modal-content { max-width: 90%; max-height: 85vh; object-fit: contain; }
        .modal-close-btn { position: absolute; top: 20px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
        .modal-close-btn:hover { color: #bbb; }

        /* Estilos para los botones de navegación del modal */
        .modal-prev, .modal-next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px; /* Centra verticalmente */
            color: white;
            font-weight: bold;
            font-size: 28px;
            transition: 0.3s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
        }
        .modal-prev { left: 0; border-radius: 3px 0 0 3px; }
        .modal-next { right: 0; border-radius: 3px 0 0 3px; }
        .modal-prev:hover, .modal-next:hover { background-color: rgba(255,255,255,0.2); }


        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- New CTA placement after gallery --- */
        .new-cta-placement {
            text-align: center;
            padding: 2rem 5%; /* Adjusted padding */
            max-width: 100vw; /* Ensure no horizontal scroll */
            overflow-x: hidden; /* Hide any overflow */
        }
        .new-cta-placement p {
            font-family: var(--font-body);
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
            line-height: 1.8;
            max-width: 800px; /* Increased max-width */
            margin: 0 auto 1.5rem auto; /* Adjusted bottom margin */
            color: #e0e0e0;
            text-transform: none;
        }
        .new-cta-placement p:first-of-type { /* Target the new "Los datos son el alma..." text */
            font-weight: 600; /* Subtle bold */
            font-style: italic; /* Italic */
            margin-bottom: 0.5rem; /* Closer to the phrase before it */
        }
        .new-cta-placement .scroll-down-arrow {
            margin: 0 auto; /* Center the arrow */
        }

        /* ----- ESTILOS NUEVA SECCIÓN: Proceso Data Análisis ----- */
        #proceso-data-analisis {
            padding: 5vh 5% 10vh 5%; /* Adjusted the padding-top to lift the section */
            background-color: var(--color-background);
            max-width: 100vw; /* Ensure no horizontal scroll */
            overflow-x: hidden; /* Hide any overflow */
        }
        #proceso-data-analisis .subtitle-text{
            text-transform: none;
            font-weight: 400;
        }
        .step-card {
            transition: all 0.3s ease;
            border-width: 2px;
            border-style: solid;
            background-color: rgba(42, 48, 56, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .step-card.active {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -4px rgba(0, 0, 0, 0.4);
        }
        .tooltip-container {
            position: relative;
            display: inline-block;
            border-bottom: 2px dotted var(--color-primary);
            cursor: help;
        }
        .tooltip-text {
            visibility: hidden; width: 280px; background-color: #393E46;
            color: #fff; text-align: left; border-radius: 6px; padding: 8px 12px;
            position: absolute; z-index: 10; bottom: 125%; left: 50%;
            margin-left: -140px; opacity: 0; transition: opacity 0.3s;
            font-size: 0.875rem; line-height: 1.25rem; font-family: var(--font-body);
            text-transform: none;
        }
        .tooltip-container:hover .tooltip-text { visibility: visible; opacity: 1; }
        
        .step-content-block {
            background-color: rgba(42, 48, 56, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--color-border);
            color: var(--color-text);
            padding: 2rem;
            border-radius: 15px;
            min-height: 200px;
            height: 100%;
        }
        .step-content-block h3 { color: var(--color-text); font-size: clamp(1.2rem, 3vw, 1.5rem); margin-bottom: 1.5rem; }
        .step-content-block p, .step-content-block ul { 
            font-family: var(--font-body); text-transform: none;
            word-wrap: break-word; /* Ensures long words break and wrap */
            overflow-wrap: break-word; /* Modern equivalent */
        }
        .step-content-block ul { list-style-position: inside; padding-left: 1rem; }
        .step-content-block ul li { margin-bottom: 0.5rem; }
        .step-content-block strong { color: var(--color-primary); }

        .phase-title {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            margin-top: 2rem; /* Adjusted margin-top to pull it up */
            margin-bottom: 4rem;
        }
        .phase-indicator {
            display: inline-block; margin-right: 0.75rem; font-size: 1.8rem; /* Increased size for indicator */
            line-height: 1;
        }
        .phase-title span:last-child { /* Target the text part of the phase title */
            font-size: clamp(1.2rem, 2.5vw, 1.6rem); /* Adjust text size for phase title */
            font-weight: 700; /* Make text bold */
        }

        .step-row {
            display: flex;
            width: 100%;
            max-width: 72rem; /* max-w-7xl */
            margin: 0 auto 2rem auto;
            position: relative;
            justify-content: center;
            align-items: stretch;
            opacity: 0; /* Changed for fade-in animation on desktop */
            transition: opacity 0.5s ease-in-out;
        }
        .step-row .step-card-container { 
            width: 12rem; /* Increased width to accommodate text */
            flex-shrink: 0; 
            flex-grow: 0; 
            padding-right: 1rem; /* Adjusted padding right */
        }
        .step-row .step-card { 
            width: 100%; 
            cursor: pointer; 
            border-radius: 0.5rem; 
            padding: 1rem; 
            text-align: center; 
            display: flex; /* Use flexbox for vertical centering */
            flex-direction: column;
            justify-content: center; /* Center content vertically */
            align-items: center;
            height: 100%; /* Ensure card takes full height of its container */
        }
        .step-row .step-card h4 { 
            font-weight: 700; 
            color: var(--color-text); 
            font-size: clamp(0.85rem, 1.5vw, 1rem); 
        }
        .step-row .step-card .text-4xl { 
            font-size: 2.25rem; 
            margin-bottom: 0.5rem; 
            line-height: 1; /* Adjust line height for emoji */
        }
        .step-row .connector { 
            position: absolute; 
            left: calc(12rem + 0.5rem); /* Adjusted left to match new card width + half of padding-right */
            top: 50%; /* Center vertically */
            transform: translateY(-50%); /* Adjust for vertical centering */
            z-index: 1; 
        }
        .step-row .connector .line { width: 4rem; height: 2px; background-color: var(--color-border); }
        .step-row .connector .dot { 
            width: 0.75rem; height: 0.75rem; border-radius: 9999px; 
            position: absolute; left: -0.375rem; top: 50%; transform: translateY(-50%); /* Centered dot */
            border: 2px solid white; 
        }
        .step-row .content-container { 
            flex: 1 1 0; 
            padding-left: 1.5rem; /* Reduced padding left to give more width to step-card-container */
        }

        .final-cta-section {
            text-align: center;
            padding: 5vh 5% 10vh; /* Ajustado el padding para moverlo más arriba */
            background-color: var(--color-background);
            position: relative;
            z-index: 2;
        }
        .final-cta-text {
            font-family: var(--font-body);
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
            line-height: 1.8;
            max-width: 800px; /* Increased max-width for more horizontal space */
            margin: 0 auto 2.5rem auto;
            color: #e0e0e0;
            text-transform: none;
        }
        .final-cta-link { /* New class for the redesigned LinkedIn icon container */
            display: inline-block;
            transition: transform 0.3s ease;
            text-decoration: none; /* Remove underline from the link */
        }
        .final-cta-link:hover {
            transform: scale(1.05);
        }

        .linkedin-circle {
            width: 100px; /* Adjust size */
            height: 100px;
            background: linear-gradient(45deg, #0077b5, #00a0dc); /* LinkedIn blue gradient */
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden; /* For glow effect */
            box-shadow: 0 0 10px rgba(0, 119, 181, 0.6); /* Initial subtle shadow */
            animation: new-pulse-glow 3s infinite ease-in-out;
            margin: 0 auto; /* Center the new LinkedIn icon */
        }

        .linkedin-text {
            font-family: 'Arial', sans-serif; /* A bold, clean font */
            font-weight: bold;
            font-size: 4rem; /* Size of 'in' */
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            z-index: 2; /* Ensure text is above any pseudo-elements for glow */
        }

        @keyframes new-pulse-glow {
            0% {
                box-shadow: 0 0 10px rgba(0, 119, 181, 0.6), inset 0 0 5px rgba(255,255,255,0.2);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 30px rgba(0, 170, 255, 1), inset 0 0 15px rgba(255,255,255,0.5); /* Stronger glow */
                transform: scale(1.05);
            }
            100% {
                box-shadow: 0 0 10px rgba(0, 119, 181, 0.6), inset 0 0 5px rgba(255,255,255,0.2);
                transform: scale(1);
            }
        }

        .linkedin-embed-container {
            max-width: 504px; /* Max width of the iframe */
            margin: 2rem auto; /* Center it and add some spacing */
            width: 100%; /* Make it responsive */
            overflow: hidden;
            border-radius: 10px; /* Optional: rounded corners for the embed */
            box-shadow: 0 5px 15px rgba(0,0,0,0.4); /* Add some shadow */
        }
        .linkedin-embed-container iframe {
            display: block; /* Remove extra space below iframe */
            width: 100%;
            height: 752px; /* Fixed height as per user request */
            border: none;
        }
        
        /* ----- Estilos para Responsividad ----- */
        @media (min-width: 769px) { /* Media query for desktop */
            .main-header {
                /* Increased padding-right for main-header in desktop */
                padding-right: 60px; 
                /* Ensure anything overflowing the main-header is clipped */
                overflow: hidden; 
            }
            .header-section.right {
                /* Let content define initial width */
                flex-basis: auto; 
                max-width: none;
                flex-shrink: 0; 
                flex-grow: 0; 
                /* Allow content to overflow this container for main-header to clip */
                overflow: visible; 
                justify-content: flex-end; /* Align content to the right */
            }
            .header-section.center {
                flex-shrink: 1; 
                flex-grow: 1; 
            }
            .header-icon {
                height: 55px; /* Fixed height for the icon container */
                /* Define a fixed width for the logo container on desktop */
                width: 150px; 
                display: flex; /* Ensure inner content is centered */
                align-items: center;
                justify-content: center;
                /* Clipping is handled here if the logo is larger than the fixed width */
                overflow: hidden; 
            }
            .header-icon img {
                height: 100%; /* Image takes 100% of its container's height (.header-icon) */
                width: auto; /* Width adjusts automatically to maintain aspect ratio */
                object-fit: contain; /* Ensure image fits without distortion */
                max-width: 100%; /* Ensure it doesn't overflow the icon container */
            }
        }

        @media (max-width: 768px) {
            :root { --header-height: 60px; }
            /* Header full width and top */
            .main-header {
                width: 100vw; 
                left: 0; 
                transform: none; 
                padding: 0 10px; /* Adjust padding for mobile */
                border-radius: var(--corner-radius); /* Apply the CSS variable radius */
                top: 10px; 
            }
            body, html {
                overflow-x: hidden; /* Ensure no horizontal scroll is possible */
            }

            .knockout-text-layer { padding-top: calc(var(--header-height) + 10px); } 
            .logo { font-size: 1.2rem; }
            .header-controls { 
                gap: 0.5rem; 
                flex-shrink: 0; 
            }
            .linkedin-icon { display: flex; flex-shrink: 0; }
            .linkedin-icon svg { width: 28px; height: 28px; }
            .header-icon { 
                height: 40px; 
                width: 40px; /* Ensure width is equal to height at this resolution */
                flex-shrink: 0; 
            }
            .header-icon img {
                max-height: 100%; 
                max-width: 100%;
                object-fit: contain;
            }
            .hamburger-icon { width: 28px; height: 22px; }
            .menu-trigger { z-index: 1005; }

            .title-container h1 { font-size: 20vw; }
            .growth-arrow { width: 25vw; height: 20vw; }
            #proceso-data-analisis, .outro-section { 
                padding: 10vh 15px; 
                max-width: 100vw;
                overflow-x: hidden;
            }
            .gallery-container, .bi-text-container, .new-cta-placement, .roadmap-container {
                max-width: 100vw;
                overflow-x: hidden;
                padding-left: 15px; 
                padding-right: 15px;
            }
            .bi-text-container { padding: 0 1.5rem; }
            .bi-text-container p { font-size: 1rem; }

            /* New CTA placement for mobile */
            .new-cta-placement {
                padding: 2rem 1rem; 
            }
            .new-cta-placement p {
                max-width: 100%; 
                font-size: 1.1rem; 
            }
            
            /* Media queries para Proceso Data Análisis (desactiva animación de aparición) */
            #proceso-data-analisis .roadmap-container > .relative { padding: 0; }
            .phase-title span:last-child { 
                font-size: clamp(1rem, 2vw, 1.2rem); 
            }
            #proceso-data-analisis .step-row {
                flex-direction: column;
                align-items: center;
                max-width: 100%;
                margin-bottom: 2rem;
                opacity: 1; 
                transition: transform 0.3s ease, box-shadow 0.3s ease; 
            }
            /* Fix for step-card-container width on mobile */
            #proceso-data-analisis .step-row .step-card-container { 
                flex: 1 1 auto; 
                width: 80%; /* Increased width for mobile cards to give more space for text */
                padding-right: 0; 
                margin: 0 auto 1rem auto; 
            }
            #proceso-data-analisis .step-row .content-container { 
                padding: 0 1rem; 
                width: 100%; 
            }
            #proceso-data-analisis .step-row .connector { display: none; }
            #proceso-data-analisis .main-vertical-line { display: none; }

            .final-cta-section {
                padding-top: 5vh; 
            }

            .tooltip-text {
                width: 200px; 
                margin-left: -100px; 
            }

            /* New LinkedIn icon responsiveness */
            .linkedin-circle {
                width: 80px;
                height: 80px;
            }
            .linkedin-text {
                font-size: 3rem;
            }

            .linkedin-embed-container {
                max-width: 100%; 
            }
            .linkedin-embed-container iframe {
                height: 500px; 
            }
        }

        @media (max-width: 480px) {
            .overlay-nav a { font-size: clamp(1.5rem, 8vw, 2.2rem); }
            :root { --menu-width: 80vw; --menu-max-width: 320px; }
            .gallery-main-image { height: 250px; }
            .header-icon { 
                height: 35px; 
                width: 35px; /* Ensure width is equal to height at this resolution */
            }
            .linkedin-icon svg { width: 24px; height: 24px; }
            .logo { font-size: 1.1rem; }
            
            .step-content-block {
                padding: 1rem; 
            }

            /* New LinkedIn icon responsiveness */
            .linkedin-circle {
                width: 70px;
                height: 70px;
            }
            .linkedin-text {
                font-size: 2.5rem;
            }

            .linkedin-embed-container iframe {
                height: 400px; 
            }
        }

        /* Mobile portrait specific adjustments */
        @media (max-width: 768px) and (orientation: portrait) {
            .knockout-text-layer {
                justify-content: center; 
                padding-top: 0; 
            }
            .subtitle-wrapper {
                margin-top: 2vh; 
            }
            .title-container h1 {
                font-size: 20vw; 
            }
            .growth-arrow {
                width: 25vw;
                height: 20vw;
            }
        }

    </style>
</head>
<body>

<div class="page-wrapper">
    <header class="main-header">
        <!-- MODIFICACIÓN: Nuevo elemento para el fondo gráfico del encabezado -->
        <div class="header-graph-background">
            <svg viewBox="0 0 100 70" preserveAspectRatio="none">
                <rect x="5" y="30" width="10" height="40" fill="var(--color-secondary)" fill-opacity="0.2"/>
                <rect x="20" y="10" width="10" height="60" fill="var(--color-secondary)" fill-opacity="0.3"/>
                <rect x="35" y="40" width="10" height="30" fill="var(--color-secondary)" fill-opacity="0.25"/>
                <rect x="50" y="0" width="10" height="70" fill="var(--color-secondary)" fill-opacity="0.35"/>
                <rect x="65" y="20" width="10" height="50" fill="var(--color-secondary)" fill-opacity="0.3"/>
                <rect x="80" y="5" width="10" height="65" fill="var(--color-secondary)" fill-opacity="0.4"/>
            </svg>
        </div>
        <div class="header-section left">
            <div class="header-controls">
                <button class="menu-trigger" aria-label="Abrir menú">
                    <div class="hamburger-icon">
                        <div class="line line-1"></div>
                        <div class="line line-2"></div>
                        <div class="line line-3"></div>
                    </div>
                </button>
                <a href="https://www.linkedin.com/in/hansen-guzm%C3%A1n-hern%C3%Aández-b4185592/" target="_blank" rel="noopener noreferrer" class="linkedin-icon" aria-label="LinkedIn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                </a>
            </div>
        </div>
        <div class="header-section center">
            <a href="#page-top" class="logo animated-gradient-text">Data Growth Hub</a>
        </div>
        <div class="header-section right">
           <!-- Removed logo from here -->
           <!-- MODIFICACIÓN: La sección derecha ahora está vacía ya que el logo se movió y el link de top ya no es necesario -->
        </div>
    </header>

    <div class="menu-overlay">
        <button class="menu-close-btn" aria-label="Cerrar menú">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
        <ul class="overlay-nav">
            <li><a href="#page-top" class="menu-link">Inicio</a></li>
            <li><a href="#evolucion" class="menu-link">Business intelligence</a></li>
            <li><a href="#galeria-bi" class="menu-link">GRÁFICOS</a></li>
            <li><a href="#proceso-data-analisis" class="menu-link">Proceso Data Análisis</a></li>
        </ul>
        <div class="menu-footer-icon">
            <a href="https://www.linkedin.com/in/hansen-guzm%C3%A1n-hern%C3%Aández-b4185592/" target="_blank" rel="noopener noreferrer" class="linkedin-icon" aria-label="LinkedIn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
            </a>
        </div>
    </div>

    <main class="main-content">
        <div class="sequence-container">
            <div class="sticky-element">
                <div class="sequence-layer background-image"></div>
                <div class="sequence-layer knockout-text-layer">
                    <div class="title-container">
                        <div class="top-row">
                            <h1>DATA</h1>
                            <svg class="growth-arrow" viewBox="0 0 120 100">
                                <!-- MODIFICACIÓN: Logo detrás de la flecha eliminado -->
                                <path d="M10 85 L 40 55 L 60 75 L 90 45 L 115 45 M105 35 L 115 45 L 105 55" />
                            </svg>
                        </div>
                        <h1>GR<span class="growth-o-logo"></span>WTH</h1>
                    </div>
                    <div class="subtitle-wrapper">
                        <p class="subtitle-text">
                            Desliza para conocer mas sobre el análisis de datos y un poco de mi trabajo
                        </p>
                        <a href="#evolucion" class="scroll-down-link" aria-label="Deslizar a Business Intelligence">
                           <svg class="scroll-down-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <section id="evolucion" class="outro-section">
            <h2 class="animated-gradient-text">Business intelligence (BI)</h2>
            
            <div class="bi-text-container">
                <p>Imagina que diriges tu empresa como si condujeras un coche. Business Intelligence (BI) sería el tablero de control. No es el motor que genera el movimiento, pero te proporciona toda la información vital; velocidad, combustible, estado del motor. Todo para tomar decisiones inteligentes al volante.</p>
                <p>De la misma forma, el BI convierte los datos brutos de ventas, marketing y operaciones en informes claros que te muestran exactamente qué ha funcionado y por qué, permitiéndote dirigir tu negocio basándote en hechos concretos y no en  intuiciones.</p>
            </div>

            <div id="galeria-bi" class="gallery-container">
                <div class="gallery-header">
                    <p>Estas imágenes son una pequeña muestra de mi trabajo en Business Intelligence (BI), son datos de muestra pero muestran un poco de mi visión analítica y creativa.</p>
                </div>
                <div class="gallery-main-image">
                    <img id="main-gallery-image" src="https://i.imgur.com/of09hLT.png" alt="Dashboard de datos principal">
                </div>
                <div class="gallery-thumbnails">
                    <div class="gallery-thumbnail active"><img src="https://i.imgur.com/of09hLT.png" alt="Dashboard de datos 1" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+1';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/DAtDSY9.png" alt="Dashboard de datos 2" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+2';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/rfbwGZf.png" alt="Dashboard de datos 3" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+3';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/o9wEf6l.png" alt="Dashboard de datos 4" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+4';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/Mm7fy4D.png" alt="Dashboard de datos 5" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+5';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/JmVH4fo.png" alt="Dashboard de datos 6" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+6';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/PfbRypg.png" alt="Dashboard de datos 7" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+7';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/O9sepwB.png" alt="Dashboard de datos 8" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+8';"></div>
                </div>
            </div>
            
            <!-- New text and original "Conoce mas herramientas" text moved here -->
            <div class="text-center my-4 new-cta-placement">
                <p class="subtitle-text" style="max-width: 800px; margin: 2rem auto 0.5rem auto; font-weight: 600; font-style: italic;">
                    "Los datos son el alma de las decisiones inteligentes: quien los entiende, los analiza y los aprovecha, transforma su negocio en una máquina de crecimiento y éxito."
                </p>
                <p class="subtitle-text" style="max-width: 800px; margin: 1.5rem auto;">
                    Conoce mas herramientas que ayudan a tu negocio a crecer con el análisis de datos
                </p>
                <a href="#proceso-data-analisis" class="scroll-down-link-2" aria-label="Deslizar a Proceso Data Análisis">
                    <svg class="scroll-down-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z"></path></svg>
                </a>
            </div>
        </section>

        <section id="proceso-data-analisis" style="padding: 5vh 5% 10vh 5%;">
            <header class="text-center mb-10 md:mb-16">
                <h2 class="animated-gradient-text" style="font-size: clamp(3rem, 8vw, 6rem); margin-bottom: 2rem; text-align: center;">Proceso Data Análisis</h2>
                <p class="text-lg text-gray-300 max-w-3xl mx-auto my-8 font-normal normal-case" style="font-family: var(--font-body); text-align: center; margin-bottom: 4rem; font-size: 1.25rem; font-weight: 500;">Una guía visual para transformar los datos de su empresa en una ventaja competitiva. Explore cada paso para entender el proceso completo.</p>
            </header>
    
            <main>
                <!-- Roadmap Visualization Container -->
                <div class="relative py-4 roadmap-container">
                    <!-- Main vertical connecting line -->
                    <div class="main-vertical-line absolute left-1/2 w-0.5 bg-gray-700 h-full transform -translate-x-1/2 z-0"></div>
    
                    <!-- Phase 1 -->
                    <div class="phase-section mb-12">
                        <h3 class="phase-title" style="color: var(--color-primary); margin-top: 2rem; margin-bottom: 4rem;">
                                <span class="phase-indicator" style="color: var(--color-primary);">&bullet;</span>
                                <span>Fase 1: Necesidades, visión y ganas de mejorar</span>
                        </h3>
                        <div class="flex flex-col items-center">
                            <!-- Step 1 Row -->
                            <div class="step-row" data-step="1">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="1" style="border-color: var(--color-primary);">
                                                <div class="text-4xl mb-2">&#x1F3AF;</div><!-- Target emoji -->
                                                <h4 class="font-bold">Definición de Necesidades</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-1"></div>
                                </div>
                            </div>
    
                            <!-- Step 2 Row -->
                            <div class="step-row" data-step="2">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="2" style="border-color: var(--color-primary);">
                                                <div class="text-4xl mb-2">&#129300;</div><!-- Face with monocle emoji -->
                                                <h4 class="font-bold">Identificar los Datos</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-2"></div>
                                </div>
                            </div>
    
                            <!-- Step 3 Row -->
                            <div class="step-row" data-step="3">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="3" style="border-color: var(--color-primary);">
                                                <div class="text-4xl mb-2">&#x1F6C1;</div><!-- Bathtub emoji -->
                                                <h4 class="font-bold">Limpieza y Preparación</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-3"></div>
                                </div>
                            </div>
    
                            <!-- Step 4 Row -->
                            <div class="step-row" data-step="4">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="4" style="border-color: var(--color-primary);">
                                                <div class="text-4xl mb-2">&#x1F9EE;</div><!-- Abacus emoji -->
                                                <h4 class="font-bold">Análisis BI</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Phase 2 -->
                    <div class="phase-section" style="margin-top: 4rem;">
                        <h3 class="phase-title" style="color: var(--color-secondary); margin-top: 2rem; margin-bottom: 4rem;">
                                <span class="phase-indicator" style="color: var(--color-secondary);">&bullet;</span>
                                <span>Fase 2: Optimización y Predicción</span>
                        </h3>
                        <div class="flex flex-col items-center">
                            <!-- Step 5 Row -->
                            <div class="step-row" data-step="5">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="5" style="border-color: var(--color-secondary);">
                                                <div class="text-4xl mb-2">&#129504;</div>
                                                <h4 class="font-bold">Machine Learning</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-secondary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-5"></div>
                                </div>
                            </div>
    
                            <!-- Step 6 Row -->
                            <div class="step-row" data-step="6">
                                <div class="step-card-container">
                                        <div class="step-card" data-step-id="6" style="border-color: var(--color-secondary);">
                                                <div class="text-4xl mb-2">&#129327;</div><!-- Exploding head emoji -->
                                                <h4 class="font-bold">Aplicación y Mejora</h4>
                                        </div>
                                </div>
                                <div class="connector">
                                        <div class="line"></div>
                                        <div class="dot" style="background-color: var(--color-secondary);"></div>
                                </div>
                                <div class="content-container">
                                        <div class="step-content-block" id="step-content-block-6"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="final-cta-section">
                    <p class="final-cta-text">
                        Si llegaste hasta aquí es por que de verdad quieres implementar Análisis de datos, si le das clic a este icono tan llamativo😅 allí me encontrarás y te daré una mano 🤜🤛
                    </p>
                    <a href="https://www.linkedin.com/in/hansen-guzm%C3%A1n-hern%C3%Aández-b4185592/" target="_blank" rel="noopener noreferrer" class="final-cta-link" aria-label="Conectar en LinkedIn">
                        <div class="linkedin-circle">
                            <span class="linkedin-text">in</span>
                        </div>
                    </a>
                    <!-- LinkedIn Embed Section -->
                    <div class="linkedin-embed-container">
                        <iframe src="https://www.linkedin.com/embed/feed/update/urn:li:ugcPost:7333188748160983044" height="752" width="504" frameborder="0" allowfullscreen="" title="Publicación integrada"></iframe>
                    </div>
                </footer>
            </div>
        </section>
    </main>

    <div id="image-modal" class="image-modal-overlay">
        <span class="modal-close-btn">&times;</span>
        <a class="modal-prev">&#10094;</a>
        <a class="modal-next">&#10095;</a>
        <img class="modal-content" id="modal-image" alt="Imagen ampliada de la galería">
    </div>
    
    <!-- SCRIPT PRINCIPAL DE LA PÁGINA -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lenis = new Lenis();
            function raf(time) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
            requestAnimationFrame(raf);

            gsap.registerPlugin(ScrollTrigger);
            lenis.on('scroll', ScrollTrigger.update);
            gsap.ticker.add((time) => {
                lenis.raf(time * 1000);
            });
            gsap.ticker.lagSmoothing(0);

            const menuTrigger = document.querySelector('.menu-trigger');
            const menuOverlay = document.querySelector('.menu-overlay');
            const menuCloseBtn = document.querySelector('.menu-close-btn');
            function toggleMenu() {
                const isActive = document.body.classList.toggle('menu-is-open');
                menuOverlay.classList.toggle('is-open');
                menuTrigger.classList.toggle('is-active');
                if (isActive) {
                    lenis.stop();
                } else {
                    lenis.start();
                }
            }
            if (menuTrigger) menuTrigger.addEventListener('click', toggleMenu);
            if (menuCloseBtn) menuCloseBtn.addEventListener('click', toggleMenu);
            
            document.querySelectorAll('.menu-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (menuOverlay.classList.contains('is-open')) {
                        toggleMenu();
                    }
                    setTimeout(() => { 
                        const targetId = link.getAttribute('href');
                        if (targetId === '#page-top') {
                            lenis.scrollTo(0, { duration: 1.5 });
                        } else {
                            lenis.scrollTo(targetId, { offset: -80 });
                        }
                    }, 600); 
                });
            });

            const topLink = document.querySelector('.top-link');
            if (topLink) { // Added null check here
                topLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    lenis.scrollTo(0, { duration: 1.5, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)) });
                });
            }

            const mm = gsap.matchMedia();

            mm.add("(min-width: 769px)", () => {
                const tl_desktop = gsap.timeline({
                    scrollTrigger: {
                        trigger: ".sequence-container",
                        start: "top top",
                        end: "bottom top", 
                        scrub: 1.5,
                        pin: ".sticky-element",
                    }
                });
                tl_desktop.to(".knockout-text-layer", { scale: 15, opacity: 0, ease: "power1.out" }, 0) 
                    .from(".background-image", { scale: 1.2, ease: "none" }, 0);
            });
            
            const scrollDownLink = document.querySelector('.scroll-down-link');
            if(scrollDownLink) {
                scrollDownLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    lenis.scrollTo('#evolucion', { offset: -20 });
                });
            }

            const scrollDownLink2 = document.querySelector('.scroll-down-link-2');
            if(scrollDownLink2) {
                scrollDownLink2.addEventListener('click', (e) => {
                    e.preventDefault();
                    lenis.scrollTo('#proceso-data-analisis', { offset: -80 });
                });
            }
            
            // --- LÓGICA DE LA GALERÍA CON NAVEGACIÓN EN MODAL ---
            const mainImageContainer = document.querySelector('.gallery-main-image');
            const mainImage = document.getElementById('main-gallery-image');
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');
            const imageModal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            const modalCloseBtn = document.querySelector('.modal-close-btn');
            const modalPrevBtn = document.querySelector('.modal-prev');
            const modalNextBtn = document.querySelector('.modal-next');
            let currentIndex = 0;
            let galleryInterval;

            if (mainImage && thumbnails.length > 0) {
                const showSlide = (index) => {
                    if (index >= thumbnails.length || index < 0) return;
                    currentIndex = index;
                    thumbnails.forEach(t => t.classList.remove('active'));
                    thumbnails[currentIndex].classList.add('active');

                    const newSrc = thumbnails[currentIndex].querySelector('img').src;
                    mainImage.style.opacity = 0;
                    setTimeout(() => {
                        mainImage.src = newSrc;
                        mainImage.style.opacity = 1;
                    }, 300);
                };

                const nextSlide = () => {
                    const nextIndex = (currentIndex + 1) % thumbnails.length;
                    showSlide(nextIndex);
                };
                
                const startSlideshow = () => {
                    clearInterval(galleryInterval);
                    galleryInterval = setInterval(nextSlide, 4000); 
                };

                thumbnails.forEach((thumb, index) => {
                    thumb.addEventListener('click', function() {
                        showSlide(index);
                        startSlideshow(); 
                    });
                });
                
                startSlideshow();

                // Lógica del Lightbox/Modal
                if (imageModal && modalImage && modalCloseBtn && modalPrevBtn && modalNextBtn) {
                    const openModal = () => {
                        modalImage.src = mainImage.src; // Opens the image currently in the carousel
                        imageModal.style.display = 'flex';
                        lenis.stop();
                    };

                    const closeModal = () => {
                        imageModal.style.display = 'none';
                        lenis.start();
                    };

                    // Function to change image within the modal
                    const changeModalImage = (direction) => {
                        currentIndex += direction;
                        // Allows the gallery to be cyclic
                        if (currentIndex >= thumbnails.length) {
                            currentIndex = 0;
                        } else if (currentIndex < 0) {
                            currentIndex = thumbnails.length - 1;
                        }
                        // Updates the modal image and the main carousel image
                        const newSrc = thumbnails[currentIndex].querySelector('img').src;
                        modalImage.src = newSrc;
                        mainImage.src = newSrc; // Also updates the main image
                        thumbnails.forEach(t => t.classList.remove('active'));
                        thumbnails[currentIndex].classList.add('active');
                    };

                    mainImageContainer.addEventListener('click', openModal);
                    modalCloseBtn.addEventListener('click', closeModal);
                    
                    // Closes the modal if clicked outside the image
                    imageModal.addEventListener('click', (e) => {
                        if (e.target === imageModal) {
                            closeModal();
                        }
                    });

                    // Event listeners for modal navigation buttons
                    modalPrevBtn.addEventListener('click', () => changeModalImage(-1));
                    modalNextBtn.addEventListener('click', () => changeModalImage(1)); /* Corrected function name */

                    // Event listener for keyboard navigation
                    document.addEventListener('keydown', (e) => {
                        if (imageModal.style.display === 'flex') {
                            if (e.key === 'ArrowLeft') {
                                changeModalImage(-1);
                            } else if (e.key === 'ArrowRight') {
                                changeModalImage(1);
                            } else if (e.key === 'Escape') {
                                closeModal();
                            }
                        }
                    });
                }
            }
            
            document.addEventListener('click', (event) => {
                if (menuOverlay.classList.contains('is-open')) {
                    const isClickInsideMenu = menuOverlay.contains(event.target);
                    const isClickOnTrigger = menuTrigger.contains(event.target);
                    if (!isClickInsideMenu && !isClickOnTrigger) {
                        toggleMenu();
                    }
                }
            });

            // Script for the new "Data Analysis Process" section
            const stepsData = [
                { id: 1, phase: 1, content: `<h3 class="text-xl font-bold mb-4">Paso 1: Definición de Necesidades y Objetivos</h3><p class="mb-4">Esta es la piedra angular. Antes de analizar cualquier dato, debemos tener absoluta claridad sobre qué preguntas de negocio queremos responder y qué metas buscamos alcanzar.</p><ul class="list-disc space-y-2"><li><strong>Identificar Necesidades:</strong> Entender los desafíos actuales y las decisiones clave.</li><li><strong>Establecer <span class="tooltip-container">KPIs<span class="tooltip-text">Un <strong>KPI</strong> (Key Performance Indicator) es una métrica medible para evaluar el éxito.</span></span>:</strong> Definir métricas específicas y medibles.</li><li><strong>Definir Objetivos Cuantificables:</strong> Traducir las necesidades en metas numéricas.</li></ul>`},
                { id: 2, phase: 1, content: `<h3 class="text-xl font-bold mb-4">Paso 2: Identificar los Datos</h3><p class="mb-4">Con los objetivos definidos, el siguiente paso es actuar como detectives de datos: encontrar dónde reside la información valiosa y establecer mecanismos para recopilarla.</p><ul class="list-disc space-y-2"><li><strong>Fuentes Internas:</strong> Bases de datos (CRM, ERP), registros de ventas, etc.</li><li><strong>Fuentes Externas:</strong> Datos de mercado, redes sociales.</li><li><strong>Tipos de Datos:</strong> <span class="tooltip-container">Estructurados<span class="tooltip-text"><strong>Datos estructurados:</strong> Formato organizado, como tablas.</span></span> y <span class="tooltip-container">No Estructurados<span class="tooltip-text"><strong>Datos no estructurados:</strong> Sin formato predefinido, como emails o imágenes.</span></span>.</li></ul>`},
                { id: 3, phase: 1, content: `<h3 class="text-xl font-bold mb-4">Paso 3: Limpieza y Preparación de Datos</h3><p class="mb-4">Los datos en su estado natural suelen estar incompletos o con errores. Decisiones basadas en datos "sucios" son peligrosas, por lo que este paso garantiza la fiabilidad.</p><ul class="list-disc space-y-2"><li><strong><span class="tooltip-container">Limpieza de Datos<span class="tooltip-text">Proceso de detectar y corregir registros incorrectos.</span></span>:</strong> Corregir errores, inconsistencias y duplicados.</li><li><strong>Transformación de Datos:</strong> Combinar fuentes y crear nuevas variables.</li></ul>`},
                { id: 4, phase: 1, content: `<h3 class="text-xl font-bold mb-4">Paso 4: Análisis BI</h3><p class="mb-4">Con datos limpios, transformamos la información en conocimiento visual y accionable, respondiendo a la pregunta: "¿Qué está sucediendo en nuestro negocio?".</p><ul class="list-disc space-y-2"><li><strong>Análisis Exploratorio:</strong> Investigar los datos para descubrir patrones y tendencias.</li><li><strong>Generación de <span class="tooltip-container">Dashboards<span class="tooltip-text">Resumen visual y en tiempo real de los KPIs más importantes.</span></span> y <span class="tooltip-container">BI<span class="tooltip-text">Conjunto de estrategias y herramientas para el análisis de datos.</span></span>:</strong> Crear visualizaciones interactivas.</li></ul>`},
                { id: 5, phase: 2, content: `<h3 class="text-xl font-bold mb-4">Paso 5: Implementación de Machine Learning</h3><p class="mb-4">Una vez que entendemos lo que ha pasado, podemos empezar a predecir lo que podría pasar, utilizando algoritmos para descubrir patrones complejos.</p><ul class="list-disc space-y-2"><li><strong>Desarrollo de Modelos:</strong> Usar <span class="tooltip-container">Machine Learning<span class="tooltip-text">Rama de la IA que permite a las máquinas aprender de los datos para hacer predicciones.</span></span> y <span class="tooltip-container">Deep Learning<span class="tooltip-text">Subcampo del ML que usa redes neuronales complejas.</span></span> para construir modelos predictivos.</li></ul>`},
                { id: 6, phase: 2, content: `<h3 class="text-xl font-bold mb-4">Paso 6: Aplicación y Mejora Continua</h3><p class="mb-4">Un modelo no tiene valor si se queda en una presentación. El objetivo es integrar estos conocimientos en los procesos de negocio para generar un impacto real y medible. Este es un ciclo que nunca termina.</p><ul class="list-disc space-y-2"><li><strong>Inyección en el Proceso:</strong> Usar predicciones para optimizar logística y personalizar campañas.</li><li><strong>Monitoreo y Refinamiento:</strong> Reentrenar y mejorar los modelos constantemente.</li></ul>`}
            ];

            const stepRows = document.querySelectorAll('#proceso-data-analisis .step-row');
            const totalSteps = stepRows.length;
            let revealInterval;
            let cardHighlightInterval;
            let restartTimeout;
            let userInteracted = false;
            let intersectionObserver; // Variable for IntersectionObserver

            function setActiveStep(stepId) {
                stepRows.forEach(row => {
                    const card = row.querySelector('.step-card');
                    const currentStepId = parseInt(card.dataset.stepId);
                    const stepData = stepsData.find(s => s.id === currentStepId);
                    const activeBorderColor = stepData.phase === 1 ? 'var(--color-primary)' : 'var(--color-secondary)';
                    
                    if (currentStepId === stepId) {
                        card.classList.add('active');
                        card.style.borderColor = activeBorderColor;
                    } else {
                        card.classList.remove('active');
                        card.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    }
                });
            }

            function startSecondaryCardAnimation() {
                clearInterval(cardHighlightInterval);
                let highlightIndex = 0;
                cardHighlightInterval = setInterval(() => {
                    if (userInteracted) {
                        clearInterval(cardHighlightInterval);
                        return;
                    }
                    setActiveStep(highlightIndex + 1);
                    highlightIndex = (highlightIndex + 1) % totalSteps;
                }, 3000);
            }

            function startAnimationCycle() {
                // Check if it's a mobile view
                const isMobile = window.innerWidth <= 768;

                // Clear any existing timers
                clearInterval(revealInterval);
                clearTimeout(restartTimeout);
                clearInterval(cardHighlightInterval);

                // Hide all steps initially if not mobile or if it's a restart
                stepRows.forEach(row => {
                    if (!isMobile) {
                        row.style.opacity = '0';
                    }
                    const contentBlock = document.getElementById(`step-content-block-${row.dataset.step}`);
                    contentBlock.innerHTML = '';
                    row.querySelector('.step-card').classList.remove('active');
                });

                // Display the first step immediately (if not mobile)
                if (!isMobile && stepRows.length > 0) {
                    const firstRow = stepRows[0];
                    const firstStepId = parseInt(firstRow.dataset.step);
                    const firstStepData = stepsData.find(s => s.id === firstStepId);
                    
                    firstRow.style.opacity = '1';
                    const firstContentBlock = document.getElementById(`step-content-block-${firstStepId}`);
                    firstContentBlock.innerHTML = firstStepData.content;
                    setActiveStep(firstStepId);
                }

                let currentStepIndex = (isMobile) ? 0 : 1; // Start from 0 if mobile, else from 1 (first step is already visible)

                const animateStep = () => {
                    if (userInteracted) {
                        clearInterval(revealInterval);
                        return;
                    }
                    if (currentStepIndex < totalSteps) {
                        const row = stepRows[currentStepIndex];
                        const stepId = parseInt(row.dataset.step);
                        const stepData = stepsData.find(s => s.id === stepId);
                        
                        // Only animate opacity if not mobile
                        if (!isMobile) {
                            row.style.opacity = '1';
                        }
                        const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                        contentBlock.innerHTML = stepData.content;
                        setActiveStep(stepId);

                        currentStepIndex++;
                    } else {
                        clearInterval(revealInterval);
                        startSecondaryCardAnimation();
                        restartTimeout = setTimeout(startAnimationCycle, 240000); // 4 minutes
                    }
                };
                
                // If mobile, show all at once and start secondary animation
                if (isMobile) {
                    stepRows.forEach((row, index) => {
                        const stepId = parseInt(row.dataset.step);
                        const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                        contentBlock.innerHTML = stepsData.find(s => s.id === stepId).content;
                        row.style.opacity = '1'; 
                    });
                    startSecondaryCardAnimation();
                    restartTimeout = setTimeout(startAnimationCycle, 240000); // 4 minutes
                } else {
                    // For desktop, reveal one by one starting from the second step
                    revealInterval = setInterval(animateStep, 1500); /* Made animation faster */
                }
            }

            document.querySelectorAll('#proceso-data-analisis .step-card').forEach(card => {
                card.addEventListener('click', function() {
                    userInteracted = true;
                    clearInterval(revealInterval);
                    clearTimeout(restartTimeout);
                    clearInterval(cardHighlightInterval);

                    // Show all rows and content
                    stepRows.forEach(row => {
                        row.style.opacity = '1';
                        const stepId = parseInt(row.dataset.step);
                        const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                        if (!contentBlock.innerHTML) {
                            const stepData = stepsData.find(s => s.id === stepId);
                            contentBlock.innerHTML = stepData.content;
                        }
                    });

                    const clickedStepId = parseInt(this.dataset.stepId);
                    setActiveStep(clickedStepId);
                });
            });

            // IntersectionObserver to start animation when section is visible
            const procesoDataAnalisisSection = document.getElementById('proceso-data-analisis');
            if (procesoDataAnalisisSection) {
                const observerOptions = {
                    root: null, // viewport
                    rootMargin: '0px',
                    threshold: 0.1 // 10% of the section visible to activate
                };

                intersectionObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && !userInteracted) {
                            startAnimationCycle();
                        } else if (!entry.isIntersecting) {
                            // If section is not visible, stop animations and allow them to restart
                            clearInterval(revealInterval);
                            clearTimeout(restartTimeout);
                            clearInterval(cardHighlightInterval);
                            userInteracted = false; // Reset user interaction to allow restart
                            // Optional: Hide cards for "reveal" effect
                            stepRows.forEach(row => {
                                if (window.innerWidth > 768) { /* Only if not mobile */
                                    row.style.opacity = '0';
                                }
                            });
                        }
                    });
                }, observerOptions);

                intersectionObserver.observe(procesoDataAnalisisSection);
            }


            // Re-run animation cycle on resize to adapt to mobile/desktop
            window.addEventListener('resize', () => {
                userInteracted = false; // Reset interaction on resize to restart animations
                // Stop observer before re-evaluating
                if (intersectionObserver) {
                    intersectionObserver.disconnect();
                }
                // Re-observe to apply correct logic
                if (procesoDataAnalisisSection) {
                    intersectionObserver.observe(procesoDataAnalisisSection);
                }
                startAnimationCycle();
            });

            // Handle navigation clicks to restart animation if scrolled to section
            document.querySelectorAll('.menu-link, .scroll-down-link-2').forEach(link => {
                link.addEventListener('click', (e) => {
                    const targetId = link.getAttribute('href');
                    if (targetId === '#proceso-data-analisis') {
                        userInteracted = false; // Reset user interaction
                        clearInterval(revealInterval);
                        clearTimeout(restartTimeout);
                        clearInterval(cardHighlightInterval);
                        // Force a re-check to start animation immediately if in view
                        if (procesoDataAnalisisSection && intersectionObserver) {
                            intersectionObserver.unobserve(procesoDataAnalisisSection); // Stop observing temporarily
                            // Force content update and activate first step instantly
                            stepRows.forEach(row => {
                                const stepId = parseInt(row.dataset.step);
                                const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                                const stepData = stepsData.find(s => s.id === stepId);
                                if (contentBlock && stepData) contentBlock.innerHTML = stepData.content;
                                if (row.dataset.step === '1') {
                                    setActiveStep(1); // Activate first step immediately
                                }
                                if (window.innerWidth > 768) {
                                    row.style.opacity = '0'; /* Reset opacity for animation if desktop */
                                }
                            });
                            setTimeout(() => { // Small delay to ensure scroll to finish, then start animation
                                startAnimationCycle();
                                intersectionObserver.observe(procesoDataAnalisisSection); // Re-observe
                            }, 500); 
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
