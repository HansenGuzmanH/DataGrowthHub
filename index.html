<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hansen Data Growth Hub | An치lisis de Datos Cinematogr치fico</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@900&display=swap" rel="stylesheet">

    <!-- Librer칤as JS (en el head para asegurar la carga) -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    
    <style>
        :root {
            --color-background: #222831; 
            --color-text: #f0f0f0;
            --color-primary: #14b8a6; /* Teal vibrante */
            --color-secondary: #FF2E63; /* Rosa ne칩n */
            --font-title: 'Montserrat', sans-serif;
            --font-body: 'Inter', sans-serif;
            --menu-width: 50vw;
            --menu-max-width: 600px;
            --header-height: 70px; 
            --corner-radius: 15px;
            --color-border: rgba(255, 255, 255, 0.1); 
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: auto; }
        body {
            font-family: var(--font-title);
            background-color: var(--color-background);
            color: var(--color-text);
            overflow-x: hidden;
        }

        /* ----- Header y Men칰 Lateral (ACTUALIZADO) ----- */
        .main-header {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 1800px; 
            border-radius: var(--corner-radius);
            background-color: rgba(26, 29, 35, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px); 
            border: 1px solid var(--color-border);
            height: var(--header-height);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
            transition: top 0.3s ease, background-color 0.3s ease; 
        }
        
        .header-section { display: flex; align-items: center; }
        .header-section.left { flex: 1 0 auto; justify-content: flex-start; }
        .header-section.center { flex: 2 1 auto; justify-content: center; text-align: center; }
        .header-section.right { flex: 1 0 auto; justify-content: flex-end; }
        
        .logo { 
            font-size: 1.6rem; 
            text-decoration: none; 
            font-weight: 900; 
            font-family: var(--font-title);
            white-space: nowrap;
        }
        
        .animated-gradient-text {
            background: linear-gradient(90deg, #EEEEEE, #00ADB5, #EEEEEE);
            background-size: 200% auto;
            color: #fff;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-flow 4s ease infinite;
        }

        @keyframes gradient-flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .header-controls { display: flex; align-items: center; gap: 1rem; }
        .linkedin-icon { color: white; transition: color 0.3s ease, transform 0.3s ease; }
        .linkedin-icon:hover { color: var(--color-primary); transform: scale(1.1); }
        .linkedin-icon svg { width: 32px; height: 32px; }
        
        .header-icon {
            height: 45px;
            width: auto;
            border-radius: 0;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
        .header-icon:hover { transform: scale(1.1); }

        .menu-trigger { background: none; border: none; cursor: pointer; z-index: 1002; padding: 10px; transition: transform 0.3s ease; }
        .menu-trigger:hover { transform: scale(1.1); }

        .hamburger-icon { width: 34px; height: 28px; display: flex; flex-direction: column; justify-content: space-between; }
        .line { width: 100%; height: 3px; background-color: white; transition: all 0.3s ease-in-out; }
        .menu-trigger.is-active .line-1 { transform: rotate(45deg) translate(8px, 8px); }
        .menu-trigger.is-active .line-2 { opacity: 0; }
        .menu-trigger.is-active .line-3 { transform: rotate(-45deg) translate(8px, -8px); }
        
        .menu-overlay { 
            position: fixed; top: 0; left: 0; 
            width: min(var(--menu-width), var(--menu-max-width)); 
            height: 100%; 
            background-color: rgba(34, 40, 49, 0.9);
            backdrop-filter: blur(20px); 
            z-index: 1001; 
            display: flex; flex-direction: column; justify-content: center;
            transform: translateX(-100%); visibility: hidden; 
            transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1), visibility 0.6s; 
        }
        .menu-overlay.is-open { transform: translateX(0); visibility: visible; }
        .menu-close-btn { position: absolute; top: 1.5rem; right: 5%; background: none; border: none; cursor: pointer; color: white; padding: 10px; transition: transform 0.4s ease; }
        .menu-close-btn:hover { transform: rotate(90deg); color: var(--color-primary); }
        .menu-close-btn svg { width: 32px; height: 32px; }
        .overlay-nav {
            list-style: none; text-align: left; padding-left: 10%; width: 100%; flex-grow: 1;
            display: flex; flex-direction: column; justify-content: flex-start; 
            padding-top: 20vh;
        }
        .overlay-nav li { margin: 1.2rem 0; transform: translateX(-20px); opacity: 0; transition: transform 0.4s ease, opacity 0.4s ease; }
        .menu-overlay.is-open .overlay-nav li { transform: translateX(0); opacity: 1; }
        .menu-overlay.is-open .overlay-nav li:nth-child(1) { transition-delay: 0.15s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(2) { transition-delay: 0.20s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(3) { transition-delay: 0.25s; }
        .menu-overlay.is-open .overlay-nav li:nth-child(4) { transition-delay: 0.30s; }
        .overlay-nav a {
            color: white; text-decoration: none; font-size: clamp(1.4rem, 3.5vw, 1.8rem);
            font-family: var(--font-title); font-weight: 700; text-transform: uppercase;
            transition: color 0.3s ease; overflow-wrap: break-word;
        }
        .overlay-nav a:hover { color: var(--color-primary); }
        
        .menu-footer-icon {
            padding: 2rem 0;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .menu-footer-icon .linkedin-icon svg { width: 48px; height: 48px; }

        /* ----- Contenido Principal y Secciones ----- */
        main { position: relative; z-index: 1; }
        h1, h2, h3, h4, h5, h6 { 
            font-family: var(--font-title); 
            text-transform: uppercase; 
            color: var(--color-text);
        }
        
        .sequence-container { position: relative; height: 100vh; }
        .sticky-element { height: 100%; width: 100%; overflow: hidden; }
        .sequence-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        
        .background-image { 
            background: radial-gradient(ellipse at center, #393E46, #222831);
            position: relative; overflow: hidden; 
        }
        
        .background-image::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(110deg, transparent 40%, rgba(255, 255, 255, 0.15) 50%, transparent 60%);
            background-size: 200% 100%; background-repeat: no-repeat;
            animation: shine-effect 5s infinite linear;
        }

        @keyframes shine-effect {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .knockout-text-layer { 
            background-color: black; mix-blend-mode: screen; 
            display: flex; flex-direction: column; justify-content: flex-start;
            align-items: center; 
            padding-top: calc(var(--header-height) + 30px);
        }

        .title-container { text-align: left; }
        .title-container .top-row { display: flex; align-items: flex-end; }
        .title-container h1 { font-size: 15vw; line-height: 0.9; color: white; }
        .growth-arrow { width: 30vw; height: 20vw; margin-left: 2vw; opacity: 0.75; }
        .growth-arrow path { stroke: #FF2E63; stroke-width: 12; stroke-linecap: round; stroke-linejoin: round; fill: none; }
        .subtitle-wrapper { margin-top: 3vh; text-align: center; width: 90%; max-width: 600px; color: rgba(255, 255, 255, 0.9); }
        .subtitle-text {
            font-family: var(--font-body); font-size: clamp(1rem, 2.5vw, 1.2rem);
            line-height: 1.7; text-transform: none; font-weight: 400;
        }
        .subtitle-text a {
            color: var(--color-primary); font-weight: bold; text-decoration: none;
            background-image: linear-gradient(var(--color-primary), var(--color-primary));
            background-size: 0% 2px; background-repeat: no-repeat; background-position: left bottom;
            transition: background-size 0.3s ease;
        }
        .subtitle-text a:hover { background-size: 100% 2px; }

        .scroll-down-arrow {
            width: 35px; height: 35px; color: white; display: block; margin: 20px auto 0;
            animation: bounce-arrow 2.5s infinite cubic-bezier(0.68, -0.55, 0.27, 1.55); cursor: pointer;
        }

        @keyframes bounce-arrow {
            0%, 100% { transform: translateY(0); opacity: 0.8; }
            50% { transform: translateY(8px); opacity: 1; }
        }
        
        .outro-section { padding: 15vh 5%; text-align: center; background-color: var(--color-background); position: relative; z-index: 2; }
        .outro-section h2 {
            text-align: center; font-size: clamp(3rem, 8vw, 6rem); margin-bottom: 5rem; 
        }
        
        .gallery-container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        .gallery-header { max-width: 900px; margin: 0 auto 2rem auto; padding: 0 2rem; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 3rem; }
        .gallery-header p { font-family: var(--font-body); font-size: 1.1rem; color: #b0b0b0; line-height: 1.7; text-transform: none; }
        
        .gallery-main-image {
            width: 100%; height: 600px; margin-bottom: 1rem; background-color: #2a3038;
            border-radius: 15px; overflow: hidden; box-shadow: 0 15px 40px rgba(0,0,0,0.6); cursor: pointer;
        }
        .gallery-main-image img { width: 100%; height: 100%; object-fit: contain; transition: opacity 0.4s ease-in-out; }
        .gallery-thumbnails { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; }
        .gallery-thumbnail {
            width: 100%; aspect-ratio: 16 / 10; border-radius: 8px; cursor: pointer; overflow: hidden;
            border: 3px solid transparent; transition: border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease; opacity: 0.6;
        }
        .gallery-thumbnail:hover { transform: scale(1.05); opacity: 1; }
        .gallery-thumbnail.active { border-color: var(--color-primary); opacity: 1; }
        .gallery-thumbnail img { width: 100%; height: 100%; object-fit: cover; }
        
        .bi-text-container {
            font-family: var(--font-body); text-align: left; max-width: 1000px; margin: 0 auto 2rem auto; 
            color: #e0e0e0; line-height: 1.8; padding: 0 2rem;
        }
        .bi-text-container p {
            font-family: var(--font-body); font-weight: 400; font-size: 1.15rem; color: #e0e0e0;
            line-height: 1.9; margin-bottom: 1.5rem; text-transform: none;
        }
        .bi-text-container p strong { color: var(--color-secondary); }
        
        /* Estilos para el Lightbox de la Galer칤a */
        .image-modal-overlay {
            position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center;
            animation: fadeIn 0.3s;
        }
        .modal-content { max-width: 90%; max-height: 85vh; object-fit: contain; }
        .modal-close-btn { position: absolute; top: 20px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
        .modal-close-btn:hover { color: #bbb; }

        /* Estilos para los botones de navegaci칩n del modal */
        .modal-prev, .modal-next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px; /* Centra verticalmente */
            color: white;
            font-weight: bold;
            font-size: 28px;
            transition: 0.3s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
        }
        .modal-prev { left: 0; border-radius: 3px 0 0 3px; }
        .modal-next { right: 0; border-radius: 3px 0 0 3px; }
        .modal-prev:hover, .modal-next:hover { background-color: rgba(255,255,255,0.2); }


        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ----- ESTILOS INSERTADOS DEL TIMELINE ----- */
        .process-inventory-h1 { /* Clase espec칤fica para evitar conflicto con h1 general */
            font-size: clamp(1.8rem, 5vw, 2.5em);
            line-height: 1.6rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 1rem;
            text-align: center;
            margin-top: 3rem;
        }
        .main-content-wrapper {
            width: 100%; max-width: 100%; margin-left: auto; margin-right: auto;
            overflow-x: auto; position: relative;
        }
        .timeline-container-custom {
            display: grid;
            grid-template-columns: repeat(5, minmax(65px, auto));
            column-gap: 18px; grid-row-gap: 120px; position: relative;
            padding-top: 160px; padding-bottom: 220px; margin: 0 auto;
            justify-content: center;
        }
        #runner-emoji {
            position: absolute; left: 0; top: 0; font-size: 1.8rem; z-index: 6;
            transition: left 0.3s ease-out, top 0.3s ease-out; pointer-events: none;
        }
        .timeline-stage-item { display: flex; flex-direction: column; align-items: center; flex-shrink: 0; padding: 5px 0; position: relative; }
        .timeline-stage-item[data-index="0"] { grid-column: 1; grid-row: 1; }
        .timeline-stage-item[data-index="1"] { grid-column: 2; grid-row: 1; }
        .timeline-stage-item[data-index="2"] { grid-column: 3; grid-row: 1; }
        .timeline-stage-item[data-index="3"] { grid-column: 4; grid-row: 1; }
        .timeline-stage-item[data-index="4"] { grid-column: 5; grid-row: 1; }
        .timeline-stage-item[data-index="5"] { grid-column: 5; grid-row: 2; } 
        .timeline-stage-item[data-index="6"] { grid-column: 4; grid-row: 2; }
        .timeline-stage-item[data-index="7"] { grid-column: 3; grid-row: 2; }
        .timeline-stage-item[data-index="8"] { grid-column: 2; grid-row: 2; }
        .timeline-stage-item[data-index="9"] { grid-column: 1; grid-row: 2; } 
        .timeline-visual-elements { display: flex; align-items: center; width: 50px; position: relative; }
        .line-segment { height: 2px; background-color: #76b900; flex-grow: 1; }
        .timeline-stage-item[data-index="0"] .line-before,
        .timeline-stage-item[data-index="4"] .line-after, 
        .timeline-stage-item[data-index="5"] .line-before, 
        .timeline-stage-item[data-index="9"] .line-after { visibility: hidden; }
        #connector-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; overflow: visible; }
        .dotted-line { fill: none; stroke: #76b900; stroke-width: 2; stroke-dasharray: 5,5; }
        #bracket-connector-path { fill: none; stroke: #76b900; stroke-width: 2; stroke-dasharray: 5,5; }
        #animated-tracer { stroke: #4d7c00; stroke-width: 4; fill: none; stroke-linecap: round; }
        .timeline-number-custom {
            width: 3.2rem; height: 3.2rem;
            background-image: linear-gradient(to bottom right, #1a2035, #101528);
            border-radius: 9999px; display: flex; justify-content: center; align-items: center;
            font-size: 1rem; font-weight: 600; color: #f0f0f0; flex-shrink: 0;
            margin: 0; box-shadow: 0 1px 3px -1px rgba(0,0,0,0.1), 0 2px 3px 0 rgba(0,0,0,0.05);
            position: relative; z-index: 1; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        .timeline-number-custom:hover { transform: scale(1.1); box-shadow: 0 4px 8px -2px rgba(118,185,0,0.4), 0 3px 6px -2px rgba(118,185,0,0.3); }
        .timeline-category-custom {
            font-size: 0.8rem; color: #ffffff; font-weight: 600; line-height: 1.2;
            margin-top: 0.4rem; text-align: center; width: auto; min-width: 40px;
            white-space: nowrap; overflow: visible; 
        }
        .timeline-stage-item.active .timeline-number-custom {
            background-image: linear-gradient(to bottom right, #8ae000, #76b900);
            box-shadow: 0 3px 6px -1px rgba(118,185,0,0.4), 0 1px 4px -2px rgba(118,185,0,0.3);
        }
        .timeline-stage-item.active .timeline-number-custom:hover { transform: scale(1.15); }
        .timeline-stage-item.active .timeline-category-custom { color: #76b900; font-weight: 700; }
        .stats-popup {
            position: absolute; background-color: #ffffff; border: 1px solid #e0e0e0;
            border-radius: 8px; box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
            padding: 10px 15px; z-index: 10; display: none; flex-direction: column;
            align-items: stretch; opacity: 0;
            transition: opacity 0.3s ease-in-out, top 0.3s ease-in-out, left 0.3s ease-in-out;
            min-width: 140px; font-size: 0.75rem; color: #333;
        }
        .stats-title { font-weight: bold; font-size: 0.85rem; margin-bottom: 8px; color: #1a2035; text-align: center; border-bottom: 1px solid #f0f0f0; padding-bottom: 6px; } 
        .stats-line { display: flex; justify-content: space-between; margin-bottom: 5px; align-items: center; }
        .stats-line:last-child { margin-bottom: 0; }
        .stats-line span:first-child { color: #555; font-weight: 500; }
        .stats-value .sign { font-weight: bold; font-size: 1.1em; margin-right: 2px; color: #dc3545; }
        .stats-value .sign.positive { color: #28a745; }
        .stats-value .number { font-weight: 500; }
        .arrow-indicator { display: inline-block; width: 0; height: 0; margin-left: 6px; vertical-align: middle; position: relative; top: -1px; }
        .arrow-indicator.up { border-left: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 8px solid #28a745; }
        .arrow-indicator.down { border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 8px solid #dc3545; }
        .navigation-controls-wrapper { position: absolute; top: 260px; left: 50%; transform: translateX(-50%); width: auto; margin-top: 0; z-index: 7; }
        .navigation-controls { display: flex; justify-content: center; align-items: center; gap: 1rem; color: #FFFFFF; }
        .nav-control-group { display: flex; flex-direction: column; align-items: center; cursor: pointer; padding: 0.3rem; }
        .nav-control-group:hover .nav-text, .nav-control-group:hover .nav-arrows { color: #e0e0e0; }
        .nav-text { font-size: 0.9rem; font-weight: 600; transition: color 0.2s ease-in-out; margin-top: 0.1rem; }
        .nav-arrows { font-size: 1.3rem; font-weight: 600; line-height: 1; transition: color 0.2s ease-in-out; }
        
        .timeline-call-to-action {
            padding-bottom: 2rem;
            text-align: center;
        }
        
        /* ----- ESTILOS NUEVA SECCI칍N: Proceso Data An치lisis ----- */
        #proceso-data-analisis {
            padding: 10vh 5%;
            background-color: var(--color-background);
        }
        #proceso-data-analisis .subtitle-text{
            text-transform: none;
            font-weight: 400;
        }
        .step-card {
            transition: all 0.3s ease;
            border-width: 2px;
            border-style: solid;
            background-color: rgba(42, 48, 56, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .step-card.active {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -4px rgba(0, 0, 0, 0.4);
        }
        .tooltip-container {
            position: relative;
            display: inline-block;
            border-bottom: 2px dotted var(--color-primary);
            cursor: help;
        }
        .tooltip-text {
            visibility: hidden; width: 280px; background-color: #393E46;
            color: #fff; text-align: left; border-radius: 6px; padding: 8px 12px;
            position: absolute; z-index: 10; bottom: 125%; left: 50%;
            margin-left: -140px; opacity: 0; transition: opacity 0.3s;
            font-size: 0.875rem; line-height: 1.25rem; font-family: var(--font-body);
            text-transform: none;
        }
        .tooltip-container:hover .tooltip-text { visibility: visible; opacity: 1; }
        
        .step-content-block {
            background-color: rgba(42, 48, 56, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--color-border);
            color: var(--color-text);
            padding: 1.5rem;
            border-radius: 15px;
            min-height: 200px;
        }
        .step-content-block h3 { color: var(--color-text); font-size: clamp(1.2rem, 3vw, 1.5rem); }
        .step-content-block p, .step-content-block ul { font-family: var(--font-body); text-transform: none; }
        .step-content-block ul { list-style-position: inside; padding-left: 1rem; }
        .step-content-block ul li { margin-bottom: 0.5rem; }
        .step-content-block strong { color: var(--color-primary); }

        .phase-title {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            margin-top: 4rem;
            margin-bottom: 4rem;
        }
        .phase-indicator {
            display: inline-block; margin-right: 0.75rem; font-size: 1.5rem;
            line-height: 1;
        }

        .step-row {
            display: flex;
            width: 100%;
            max-width: 72rem; /* max-w-7xl */
            margin: 0 auto 2rem auto;
            position: relative;
            justify-content: center;
            align-items: flex-start;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .step-row .step-card-container { flex: 0 0 12rem; padding-right: 2rem; }
        .step-row .step-card { width: 100%; cursor: pointer; border-radius: 0.5rem; padding: 1rem; text-align: center; }
        .step-row .step-card h4 { font-weight: 700; color: var(--color-text); }
        .step-row .step-card .text-4xl { font-size: 2.25rem; margin-bottom: 0.5rem; }
        .step-row .connector { position: absolute; left: 12rem; top: 3.5rem; transform: translate(-50%, -50%); z-index: 1; }
        .step-row .connector .line { width: 4rem; height: 2px; background-color: var(--color-border); }
        .step-row .connector .dot { width: 0.75rem; height: 0.75rem; border-radius: 9999px; position: absolute; left: -0.375rem; top: -0.31rem; border: 2px solid white; }
        .step-row .content-container { flex: 1 1 0; padding-left: 4rem; }
        
        /* ----- Estilos para Responsividad ----- */
        @media (max-width: 768px) {
            :root { --header-height: 60px; }
            .knockout-text-layer { padding-top: calc(8vh + 30px); }
            .logo { font-size: 1.2rem; }
            .header-controls { gap: 0.5rem; }
            .linkedin-icon { display: flex; }
            .linkedin-icon svg { width: 28px; height: 28px; }
            .header-icon { display: block; height: 40px; }
            .hamburger-icon { width: 28px; height: 22px; }
            .title-container h1 { font-size: 20vw; }
            .growth-arrow { width: 25vw; height: 20vw; }
            #proceso-data-analisis, .outro-section { padding: 10vh 5%; }
            #proceso-data-analisis h2, .outro-section h2 { font-size: clamp(2rem, 10vw, 3.5rem); }
            .main-content-wrapper { padding: 0 1rem 20px 1rem; }
            .gallery-main-image { height: 400px; }
            .gallery-thumbnails { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); }
            .bi-text-container { padding: 0 1.5rem; }
            .bi-text-container p { font-size: 1rem; }

            /* Media queries para los gr치ficos insertados */
            .timeline-container-custom {
                padding-top: 120px; padding-bottom: 140px;
                grid-template-columns: repeat(5, minmax(50px, auto)); 
                column-gap: 12px; grid-row-gap: 100px; 
            }
            .navigation-controls-wrapper { top: 200px; }
            #runner-emoji { font-size: 1.5rem; }
            .timeline-visual-elements { width: 35px; } 
            .timeline-number-custom { width: 2.6rem; height: 2.6rem; font-size: 0.9rem;} 
            .timeline-category-custom { font-size: 0.7rem; min-width: 30px; margin-top: 0.2rem; } 
            .stats-popup { font-size: 0.7rem; min-width: 120px; padding: 6px 10px; }
            .stats-title { font-size: 0.75rem; }
            .nav-text { font-size: 0.8rem; }
            .nav-arrows { font-size: 1.1rem; }
            .timeline-call-to-action { margin-top: 2rem; }

            /* Media queries para Proceso Data An치lisis */
            #proceso-data-analisis .roadmap-container > .relative { padding: 0; }
            #proceso-data-analisis .step-row { flex-direction: column; align-items: center; max-width: 100%;}
            #proceso-data-analisis .step-row .step-card-container { justify-content: center; padding: 0; margin-bottom: 1rem; }
            #proceso-data-analisis .step-row .content-container { padding: 0; width: 100%; }
            #proceso-data-analisis .step-row .connector { display: none; }
            #proceso-data-analisis .main-vertical-line { display: none; }
        }

        @media (max-width: 480px) {
            .overlay-nav a { font-size: clamp(1.5rem, 8vw, 2.2rem); }
            :root { --menu-width: 80vw; --menu-max-width: 320px; }
            .gallery-main-image { height: 250px; }
            .header-icon { height: 35px; width: auto; }
            .linkedin-icon svg { width: 24px; height: 24px; }
            .logo { font-size: 1.1rem; }
            
            /* Media queries para los gr치ficos insertados */
            .timeline-visual-elements { width: 25px; } 
            .timeline-number-custom { width: 2.4rem; height: 2.4rem; font-size: 0.8rem;} 
            .timeline-category-custom { font-size: 0.65rem; min-width: 25px; } 
            .timeline-container-custom {
                grid-template-columns: repeat(5, minmax(40px, auto)); 
                column-gap: 8px; padding-top: 110px; padding-bottom: 120px;
            }
            .navigation-controls-wrapper { top: 185px; }
            .nav-text { font-size: 0.75rem; }
            .nav-arrows { font-size: 1rem; }
        }

    </style>
</head>
<body id="page-top">

<div class="page-wrapper">
    <header class="main-header">
        <div class="header-section left">
            <div class="header-controls">
                <button class="menu-trigger" aria-label="Abrir men칰">
                    <div class="hamburger-icon">
                        <div class="line line-1"></div>
                        <div class="line line-2"></div>
                        <div class="line line-3"></div>
                    </div>
                </button>
                <a href="https://www.linkedin.com/in/hansen-guzm%C3%A1n-hern%C3%A1ndez-b4185592/" target="_blank" rel="noopener noreferrer" class="linkedin-icon" aria-label="LinkedIn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                </a>
            </div>
        </div>
        <div class="header-section center">
            <a href="#page-top" class="logo animated-gradient-text">Data Growth Hub</a>
        </div>
        <div class="header-section right">
           <a href="#page-top" class="top-link" aria-label="Ir al inicio de la p치gina">
               <img src="https://i.imgur.com/I9NzDmR.png" alt="Icono de Hansen" class="header-icon" onerror="this.onerror=null;this.src='https://placehold.co/120x45/222831/eeeeee?text=Logo';">
           </a>
        </div>
    </header>

    <div class="menu-overlay">
        <button class="menu-close-btn" aria-label="Cerrar men칰">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
        <ul class="overlay-nav">
            <li><a href="#page-top" class="menu-link">Inicio</a></li>
            <li><a href="#evolucion" class="menu-link">Business intelligence</a></li>
            <li><a href="#proceso-data-analisis" class="menu-link">Proceso Data An치lisis</a></li>
            <li><a href="#galeria-bi" class="menu-link">GR츼FICOS</a></li>
        </ul>
        <div class="menu-footer-icon">
            <a href="https://www.linkedin.com/in/hansen-guzm%C3%A1n-hern%C3%A1ndez-b4185592/" target="_blank" rel="noopener noreferrer" class="linkedin-icon" aria-label="LinkedIn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
            </a>
        </div>
    </div>

    <main class="main-content">
        <div class="sequence-container">
            <div class="sticky-element">
                <div class="sequence-layer background-image"></div>
                <div class="sequence-layer knockout-text-layer">
                    <div class="title-container">
                        <div class="top-row">
                            <h1>DATA</h1>
                            <svg class="growth-arrow" viewBox="0 0 120 100">
                                <path d="M10 85 L 40 55 L 60 75 L 90 45 L 115 45 M105 35 L 115 45 L 105 55" />
                            </svg>
                        </div>
                        <h1>GROWTH</h1>
                    </div>
                    <div class="subtitle-wrapper">
                        <p class="subtitle-text">
                          Desliza para conocer mas sobre el an치lisis de datos y un poco de mi trabajo
                        </p>
                        <a href="#evolucion" class="scroll-down-link" aria-label="Deslizar a Business Intelligence">
                           <svg class="scroll-down-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <section id="evolucion" class="outro-section">
            <h2 class="animated-gradient-text">Business intelligence (BI)</h2>
            
            <div class="bi-text-container">
                <p>Imagina que diriges tu empresa como si condujeras un coche. Business Intelligence (BI) ser칤a el tablero de control. No es el motor que genera el movimiento, pero te proporciona toda la informaci칩n vital; velocidad, combustible, estado del motor. Todo para tomar decisiones inteligentes al volante.</p>
                <p>De la misma forma, el BI convierte los datos brutos de ventas, marketing y operaciones en informes claros que te muestran exactamente qu칠 ha funcionado y por qu칠, permiti칠ndote dirigir tu negocio bas치ndote en hechos concretos y no en  intuiciones.</p>
            </div>

            <div id="galeria-bi" class="gallery-container">
                <div class="gallery-header">
                    <p>Estas im치genes son una peque침a muestra de mi trabajo en Business Intelligence (BI), son datos de muestra pero muestran un poco de mi visi칩n anal칤tica y creativa.</p>
                </div>
                <div class="gallery-main-image">
                    <img id="main-gallery-image" src="https://i.imgur.com/of09hLT.png" alt="Dashboard de datos principal">
                </div>
                <div class="gallery-thumbnails">
                    <div class="gallery-thumbnail active"><img src="https://i.imgur.com/of09hLT.png" alt="Dashboard de datos 1" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+1';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/DAtDSY9.png" alt="Dashboard de datos 2" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+2';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/rfbwGZf.png" alt="Dashboard de datos 3" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+3';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/o9wEf6l.png" alt="Dashboard de datos 4" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+4';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/Mm7fy4D.png" alt="Dashboard de datos 5" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+5';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/JmVH4fo.png" alt="Dashboard de datos 6" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+6';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/PfbRypg.png" alt="Dashboard de datos 7" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+7';"></div>
                    <div class="gallery-thumbnail"><img src="https://i.imgur.com/O9sepwB.png" alt="Dashboard de datos 8" onerror="this.onerror=null;this.src='https://placehold.co/120x80/222831/eeeeee?text=Img+8';"></div>
                </div>
            </div>

            <!-- ===== INICIO DEL CONTENIDO INSERTADO ===== -->
            <h1 class="process-inventory-h1">Procces Inventory</h1> 
            <div class="main-content-wrapper">
                <div class="timeline-container-custom">
                    <div id="runner-emoji">游</div>
                    <div id="stats-popup" class="stats-popup">
                        <div class="stats-title">Stats YTD y MTD</div>
                        <div class="stats-line"><span>YTD:</span><span class="stats-value" id="ytd-value"></span></div>
                        <div class="stats-line"><span>MTD:</span><span class="stats-value" id="mtd-value"></span></div>
                    </div>
                    <svg id="connector-svg"> 
                        <path id="dotted-line-row1" class="dotted-line" d=""></path>
                        <path id="dotted-line-row2" class="dotted-line" d=""></path>
                        <path id="bracket-connector-path" d=""></path> 
                        <path id="animation-guide-path" style="display:none;"></path> 
                        <path id="animated-tracer" style="display:none;"></path> 
                    </svg>
        
                    <div class="timeline-stage-item active" data-index="0">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">101</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Opened</div>
                    </div>
                    <div class="timeline-stage-item" data-index="1">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">250</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #1</div>
                    </div>
                    <div class="timeline-stage-item" data-index="2">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">3</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #2</div>
                    </div>
                    <div class="timeline-stage-item" data-index="3">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">42</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #3</div>
                    </div>
                    <div class="timeline-stage-item" data-index="4">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">555</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #4</div>
                    </div>
                    <div class="timeline-stage-item" data-index="5">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">68</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #5</div>
                    </div>
                    <div class="timeline-stage-item" data-index="6">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">700</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #6</div>
                    </div>
                    <div class="timeline-stage-item" data-index="7">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">81</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #7</div>
                    </div>
                    <div class="timeline-stage-item" data-index="8">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">909</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Stage #8</div>
                    </div>
                    <div class="timeline-stage-item" data-index="9">
                        <div class="timeline-visual-elements">
                            <div class="line-segment line-before"></div><div class="timeline-number-custom">10</div><div class="line-segment line-after"></div>
                        </div><div class="timeline-category-custom">Closed</div>
                    </div>
                    
                    <div class="navigation-controls-wrapper">
                        <div class="navigation-controls">
                            <div class="nav-control-group" onclick="prevStep()">
                                <span class="nav-arrows">&lt;&lt;</span>
                                <span class="nav-text">Back</span>
                            </div>
                            <div class="nav-control-group" onclick="nextStep()">
                                <span class="nav-arrows">&gt;&gt;</span>
                                <span class="nav-text">Forward</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
             <div class="subtitle-wrapper timeline-call-to-action">
                  <p class="subtitle-text" style="max-width: 500px; margin: 0 auto;">
                      Conoce mas herramientas que ayudan a tu negocio a crecer con el an치lisis de datos
                  </p>
                  <a href="#proceso-data-analisis" class="scroll-down-link-2" aria-label="Deslizar a Proceso Data An치lisis">
                     <svg class="scroll-down-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z"></path></svg>
                  </a>
              </div>
            <!-- ===== FIN DEL CONTENIDO INSERTADO ===== -->
        </section>

        <section id="proceso-data-analisis" style="padding: 10vh 5%;">
            <header class="text-center">
                <h2 class="animated-gradient-text" style="font-size: clamp(3rem, 8vw, 6rem); margin-bottom: 2rem; text-align: center;">Proceso Data An치lisis</h2>
                <p class="text-lg text-gray-300 max-w-3xl mx-auto my-8 font-normal normal-case" style="font-family: var(--font-body); text-align: center;">Una gu칤a visual para transformar los datos de su empresa en una ventaja competitiva. Explore cada paso para entender el proceso completo.</p>
            </header>
    
            <main>
                <!-- Roadmap Visualization Container -->
                <div class="relative py-4 roadmap-container">
                    <!-- Main vertical connecting line -->
                    <div class="main-vertical-line absolute left-1/2 w-0.5 bg-gray-700 h-full transform -translate-x-1/2 z-0"></div>
    
                    <!-- Phase 1 -->
                    <div class="phase-section mb-12">
                        <h3 class="phase-title" style="color: var(--color-primary); margin-top: 4rem; margin-bottom: 6rem;">
                            <span class="phase-indicator" style="color: var(--color-primary);">&#x25CF;</span>
                            <span>Necesidades, visi칩n y ganas de mejorar</span>
                        </h3>
                        <div class="flex flex-col items-center">
                            <!-- Step 1 Row -->
                            <div class="step-row" data-step="1">
                                <div class="step-card-container">
                                    <div class="step-card" data-step-id="1" style="border-color: var(--color-primary);">
                                        <div class="text-4xl mb-2">&#x1F4AF;</div>
                                        <h4 class="font-bold">Definici칩n de Necesidades</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-1"></div>
                                </div>
                            </div>
    
                            <!-- Step 2 Row -->
                            <div class="step-row" data-step="2">
                                 <div class="step-card-container">
                                    <div class="step-card" data-step-id="2" style="border-color: var(--color-primary);">
                                        <div class="text-4xl mb-2">&#128269;</div>
                                        <h4 class="font-bold">Identificaci칩n de Datos</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-2"></div>
                                </div>
                            </div>
    
                            <!-- Step 3 Row -->
                            <div class="step-row" data-step="3">
                                 <div class="step-card-container">
                                    <div class="step-card" data-step-id="3" style="border-color: var(--color-primary);">
                                        <div class="text-4xl mb-2">&#128490;</div>
                                        <h4 class="font-bold">Limpieza y Preparaci칩n</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-3"></div>
                                </div>
                            </div>
    
                            <!-- Step 4 Row -->
                            <div class="step-row" data-step="4">
                                 <div class="step-card-container">
                                    <div class="step-card" data-step-id="4" style="border-color: var(--color-primary);">
                                        <div class="text-4xl mb-2">&#128202;</div>
                                        <h4 class="font-bold">An치lisis y BI</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-primary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Phase 2 -->
                    <div class="phase-section">
                        <h3 class="phase-title" style="color: var(--color-secondary); margin-top: 4rem; margin-bottom: 6rem;">
                            <span class="phase-indicator" style="color: var(--color-secondary);">&#x25CF;</span>
                            <span>Fase 2: Optimizaci칩n y Predicci칩n</span>
                        </h3>
                        <div class="flex flex-col items-center">
                            <!-- Step 5 Row -->
                            <div class="step-row" data-step="5">
                                <div class="step-card-container">
                                    <div class="step-card" data-step-id="5" style="border-color: var(--color-secondary);">
                                        <div class="text-4xl mb-2">&#129504;</div>
                                        <h4 class="font-bold">Machine Learning</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-secondary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-5"></div>
                                </div>
                            </div>
    
                            <!-- Step 6 Row -->
                            <div class="step-row" data-step="6">
                                <div class="step-card-container">
                                    <div class="step-card" data-step-id="6" style="border-color: var(--color-secondary);">
                                        <div class="text-4xl mb-2">&#x21BB;</div>
                                        <h4 class="font-bold">Aplicaci칩n y Mejora</h4>
                                    </div>
                                </div>
                                <div class="connector">
                                    <div class="line"></div>
                                    <div class="dot" style="background-color: var(--color-secondary);"></div>
                                </div>
                                <div class="content-container">
                                    <div class="step-content-block" id="step-content-block-6"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </section>
    </main>

    <div id="image-modal" class="image-modal-overlay">
        <span class="modal-close-btn">&times;</span>
        <a class="modal-prev">&#10094;</a>
        <a class="modal-next">&#10095;</a>
        <img class="modal-content" id="modal-image" alt="Imagen ampliada de la galer칤a">
    </div>
    
    <!-- SCRIPT DEL TIMELINE INSERTADO -->
    <script>
    (() => {
        let currentStep = 0;
        const timelineItems = document.querySelectorAll('.timeline-stage-item');
        const runnerEmoji = document.getElementById('runner-emoji');
        const timelineContainer = document.querySelector('.timeline-container-custom');
        const statsPopup = document.getElementById('stats-popup');
        const bracketConnectorPathEl = document.getElementById('bracket-connector-path'); 
        const dottedLineRow1PathEl = document.getElementById('dotted-line-row1'); 
        const dottedLineRow2PathEl = document.getElementById('dotted-line-row2'); 
        const animationGuidePathEl = document.getElementById('animation-guide-path');
        const animatedTracerEl = document.getElementById('animated-tracer');
        const connectorSvg = document.getElementById('connector-svg'); 
        let scrollTimeoutId = null;
        let popupTimeoutId = null;
        let currentStats = { ytd: null, mtd: null }; 

        if (timelineItems.length === 0) return; // No ejecutar si los elementos no existen

        const animationState = {
            tracer: { progress: 0, direction: 1, pathLength: 0, speed: 1, element: animatedTracerEl, guidePathElement: animationGuidePathEl, segmentLength: 15 }
        };
        let animationFrameId = null;


        function generateStatData() {
            const value = Math.floor(Math.random() * 99) + 1;
            const isPositive = Math.random() < 0.7;
            return { value, isPositive };
        }

        function formatStat(statData) {
            if (!statData) return ''; 
            const signChar = statData.isPositive ? '+' : '-';
            const arrowClass = statData.isPositive ? 'up' : 'down';
            const signClass = statData.isPositive ? 'positive' : '';
            return `<span class="sign ${signClass}">${signChar}</span> <span class="number">${statData.value}%</span> <span class="arrow-indicator ${arrowClass}"></span>`;
        }
        
        function updateDottedLines() {
            if (!dottedLineRow1PathEl || !dottedLineRow2PathEl || timelineItems.length < 5) { 
                if(dottedLineRow1PathEl) dottedLineRow1PathEl.setAttribute('d', '');
                if(dottedLineRow2PathEl) dottedLineRow2PathEl.setAttribute('d', '');
                return ""; 
            }

            const containerRect = timelineContainer.getBoundingClientRect();
            let d1 = "", d2 = "";

            const circle0 = timelineItems[0].querySelector('.timeline-number-custom');
            const circle4 = timelineItems[4].querySelector('.timeline-number-custom');
            if (circle0 && circle4) {
                const circle0Rect = circle0.getBoundingClientRect();
                const circle4Rect = circle4.getBoundingClientRect();

                const r1StartX = (circle0Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle0Rect.width / 2);
                const r1StartY = (circle0Rect.top - containerRect.top + timelineContainer.scrollTop) + (circle0Rect.height / 2);
                const r1EndX = (circle4Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle4Rect.width / 2);
                d1 = `M ${r1StartX} ${r1StartY} L ${r1EndX} ${r1StartY}`;
                dottedLineRow1PathEl.setAttribute('d', d1);
            } else {
                dottedLineRow1PathEl.setAttribute('d', '');
            }

            if (timelineItems.length >= 10) {
                const circle9 = timelineItems[9].querySelector('.timeline-number-custom'); 
                const circle5 = timelineItems[5].querySelector('.timeline-number-custom'); 
                 if (circle9 && circle5) {
                    const circle9Rect = circle9.getBoundingClientRect();
                    const circle5Rect = circle5.getBoundingClientRect();

                    const r2StartX = (circle9Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle9Rect.width / 2);
                    const r2StartY = (circle9Rect.top - containerRect.top + timelineContainer.scrollTop) + (circle9Rect.height / 2);
                    const r2EndX = (circle5Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle5Rect.width / 2);
                    d2 = `M ${r2StartX} ${r2StartY} L ${r2EndX} ${r2StartY}`;
                    dottedLineRow2PathEl.setAttribute('d', d2);
                 } else {
                      dottedLineRow2PathEl.setAttribute('d', '');
                 }
            } else {
                 dottedLineRow2PathEl.setAttribute('d', '');
            }
            return {d1, d2}; 
        }

        function updateBracketConnectorPath() { 
            if (!bracketConnectorPathEl || !connectorSvg || timelineItems.length < 6) {
                if(bracketConnectorPathEl) bracketConnectorPathEl.setAttribute('d', '');
                return ""; 
            }
            
            const item4 = timelineItems[4]; 
            const item5 = timelineItems[5]; 
            if (!item4 || !item5) {
                 if(bracketConnectorPathEl) bracketConnectorPathEl.setAttribute('d', '');
                return "";
            }

            const circle4 = item4.querySelector('.timeline-number-custom');
            const circle5 = item5.querySelector('.timeline-number-custom');
            if (!circle4 || !circle5) {
                if(bracketConnectorPathEl) bracketConnectorPathEl.setAttribute('d', '');
                return "";
            }

            const containerRect = timelineContainer.getBoundingClientRect();
            const circle4Rect = circle4.getBoundingClientRect();
            const circle5Rect = circle5.getBoundingClientRect();
            
            const barExtension = 20; 

            const p0x = (circle4Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle4Rect.width / 2);
            const p0y = (circle4Rect.top - containerRect.top + timelineContainer.scrollTop) + (circle4Rect.height / 2);

            const p3x = (circle5Rect.left - containerRect.left + timelineContainer.scrollLeft) + (circle5Rect.width / 2);
            const p3y = (circle5Rect.top - containerRect.top + timelineContainer.scrollTop) + (circle5Rect.height / 2);
            
            const bracketSpineX = Math.max(p0x, p3x) + (circle4Rect.width / 2) + barExtension;

            const pathD = `M ${p0x} ${p0y} L ${bracketSpineX} ${p0y} L ${bracketSpineX} ${p3y} L ${p3x} ${p3y}`;
            bracketConnectorPathEl.setAttribute('d', pathD);
            return pathD; 
        }

        function updateAnimationGuidePath() {
            const paths = updateDottedLines();
            const bracketPath = updateBracketConnectorPath();

            let combinedD = "";
            if (paths.d1) combinedD += paths.d1;
            
            if (bracketPath) {
                const bracketPoints = bracketPath.split(/[ML]/).filter(s => s.trim() !== '').map(pair => pair.trim().split(' '));
                if (bracketPoints.length === 4) {
                    if (combinedD) { 
                        combinedD += ` L ${bracketPoints[1][0]} ${bracketPoints[1][1]}`;
                        combinedD += ` L ${bracketPoints[2][0]} ${bracketPoints[2][1]}`;
                        combinedD += ` L ${bracketPoints[3][0]} ${bracketPoints[3][1]}`;
                    } else {
                        combinedD = bracketPath;
                    }
                }
            }

            if (paths.d2) { 
                const d2_parts = paths.d2.split(' ');
                const d2_for_animation = `M ${d2_parts[4]} ${d2_parts[5]} L ${d2_parts[1]} ${d2_parts[2]}`;
                if (combinedD) combinedD += " " + d2_for_animation.substring(1);
                else combinedD += d2_for_animation;
            }
            
            if (animationGuidePathEl) {
                animationGuidePathEl.setAttribute('d', combinedD);
                if (combinedD) {
                    animationState.tracer.pathLength = animationGuidePathEl.getTotalLength();
                } else {
                    animationState.tracer.pathLength = 0;
                }
                animationState.tracer.progress = 0; 
                animationState.tracer.direction = 1;
            }
        }

        function animateTracerLoop() {
            const state = animationState.tracer;
            if (state.pathLength > 0 && state.element && state.guidePathElement && state.guidePathElement.getAttribute('d')) {
                state.progress += state.speed * state.direction;

                if (state.progress >= state.pathLength) {
                    state.progress = state.pathLength;
                    state.direction = -1;
                } else if (state.progress <= 0) {
                    state.progress = 0;
                    state.direction = 1;
                }
                
                try {
                    const currentPos = state.guidePathElement.getPointAtLength(state.progress);
                    let nextProgress = state.progress + (state.segmentLength * state.direction);
                    if (nextProgress > state.pathLength) nextProgress = state.pathLength;
                    if (nextProgress < 0) nextProgress = 0;
                    
                    const nextPos = state.guidePathElement.getPointAtLength(nextProgress);
                    
                    state.element.setAttribute('d', `M ${currentPos.x} ${currentPos.y} L ${nextPos.x} ${nextPos.y}`);
                    state.element.style.display = 'block';

                } catch(e) {
                    state.element.style.display = 'none';
                }
            } else if (state.element) {
                state.element.style.display = 'none';
            }
            animationFrameId = requestAnimationFrame(animateTracerLoop);
        }


        function positionEmoji() { 
            const activeItem = timelineItems[currentStep];
            if (!activeItem) return;

            const activeCircle = activeItem.querySelector('.timeline-number-custom');
            const categoryText = activeItem.querySelector('.timeline-category-custom');
            if (!activeCircle || !categoryText || !runnerEmoji || !timelineContainer || !statsPopup) return;
            
            const isMobileView = window.innerWidth <= 767;
            const isBottomRow = currentStep >= 5;
            runnerEmoji.offsetHeight; 

            const activeCircleRect = activeCircle.getBoundingClientRect();
            const timelineContainerRect = timelineContainer.getBoundingClientRect();
            const categoryTextRect = categoryText.getBoundingClientRect(); 

            const circleCenterX = (activeCircleRect.left - timelineContainerRect.left + timelineContainer.scrollLeft) + (activeCircleRect.width / 2);
            
            let emojiTargetX, emojiTargetY;
            let popupTopValue, popupLeftValue;

            if (isMobileView) {
                emojiTargetX = 10; 
                if (isBottomRow) {
                    const textBottomY = (categoryTextRect.bottom - timelineContainerRect.top + timelineContainer.scrollTop);
                    emojiTargetY = textBottomY + 10; 
                } else { 
                    const circleTopYRel = (activeCircleRect.top - timelineContainerRect.top + timelineContainer.scrollTop);
                     emojiTargetY = circleTopYRel + (activeCircleRect.height / 2) - (runnerEmoji.offsetHeight / 2) - 5; 
                }
            } else { 
                emojiTargetX = circleCenterX - (runnerEmoji.offsetWidth / 2); 
                if (isBottomRow) {
                    const textBottomY = (categoryTextRect.bottom - timelineContainerRect.top + timelineContainer.scrollTop);
                    emojiTargetY = textBottomY + 10; 
                } else { 
                    const circleTopYRel = (activeCircleRect.top - timelineContainerRect.top + timelineContainer.scrollTop);
                    emojiTargetY = circleTopYRel - runnerEmoji.offsetHeight - 5; 
                }
            }
            runnerEmoji.style.left = emojiTargetX + 'px';
            runnerEmoji.style.top = emojiTargetY + 'px';

            statsPopup.style.display = 'flex'; 
            const popupWidth = statsPopup.offsetWidth;
            popupLeftValue = circleCenterX - (popupWidth / 2); 

            if (isBottomRow) {
                popupTopValue = emojiTargetY + runnerEmoji.offsetHeight + 5; 
            } else { 
                popupTopValue = 5; 
            }

            const containerScrollLeft = timelineContainer.scrollLeft;
            const containerClientWidth = timelineContainer.clientWidth;

            if (popupLeftValue < containerScrollLeft) {
                 popupLeftValue = containerScrollLeft + 5; 
            }
            if (popupLeftValue + popupWidth > containerScrollLeft + containerClientWidth) {
                 popupLeftValue = containerScrollLeft + containerClientWidth - popupWidth - 5; 
            }
            if (popupLeftValue < containerScrollLeft && containerClientWidth < popupWidth) {
                popupLeftValue = containerScrollLeft + 5;
            }

            statsPopup.style.left = popupLeftValue + 'px';
            statsPopup.style.top = popupTopValue + 'px';
        }

        function updateActiveState() {
            let activeItem = null;
            timelineItems.forEach((item, index) => {
                if (index === currentStep) {
                    item.classList.add('active');
                    activeItem = item;
                } else {
                    item.classList.remove('active');
                }
            });

            if (activeItem) {
                currentStats.ytd = generateStatData();
                currentStats.mtd = generateStatData();
                document.getElementById('ytd-value').innerHTML = formatStat(currentStats.ytd);
                document.getElementById('mtd-value').innerHTML = formatStat(currentStats.mtd);
                
                statsPopup.style.visibility = 'visible'; 
                statsPopup.style.opacity = '1'; 

                clearTimeout(popupTimeoutId); 
                popupTimeoutId = setTimeout(() => { 
                    statsPopup.style.opacity = '0';
                    setTimeout(() => {
                        if (statsPopup.style.opacity === '0') { 
                             statsPopup.style.display = 'none';
                             statsPopup.style.visibility = 'hidden';
                        }
                    }, 300); 
                }, 10000);


                const itemRect = activeItem.getBoundingClientRect();
                const isItemHorizontallyVisibleInContainer = 
                    (itemRect.left >= timelineContainer.getBoundingClientRect().left && 
                     itemRect.right <= timelineContainer.getBoundingClientRect().right) ||
                    (itemRect.left <= timelineContainer.getBoundingClientRect().left && 
                     itemRect.right >= timelineContainer.getBoundingClientRect().right);

                if (!isItemHorizontallyVisibleInContainer && timelineContainer.scrollWidth > timelineContainer.clientWidth) {
                     activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                }
                
                requestAnimationFrame(() => { 
                    requestAnimationFrame(() => { 
                         positionEmoji();
                         updateDottedLines(); 
                         updateBracketConnectorPath(); 
                         updateAnimationGuidePath(); 
                    });
                });
            } else {
                 updateDottedLines(); 
                 updateBracketConnectorPath(); 
                 updateAnimationGuidePath();
                 statsPopup.style.opacity = '0'; 
                 statsPopup.style.visibility = 'hidden';
            }
        }

        window.nextStep = function() {
            currentStep = (currentStep + 1) % timelineItems.length;
            updateActiveState();
        }

        window.prevStep = function() {
            currentStep--;
            if (currentStep < 0) currentStep = timelineItems.length - 1;
            updateActiveState();
        }

        timelineItems.forEach((item, index) => {
            const circle = item.querySelector('.timeline-number-custom');
            if(circle) {
                circle.addEventListener('click', () => {
                    currentStep = index; 
                    updateActiveState();
                });
            }
        });
        
        const scrollableElement = document.querySelector('.main-content-wrapper');
        function handleScroll() { 
            clearTimeout(scrollTimeoutId);
            scrollTimeoutId = setTimeout(() => {
                if (timelineItems.length > 0) {
                     requestAnimationFrame(() => { 
                         positionEmoji(); 
                         updateDottedLines(); 
                         updateBracketConnectorPath(); 
                         updateAnimationGuidePath();
                    });
                }
            }, 100); 
        }
        
        if(scrollableElement) scrollableElement.addEventListener('scroll', handleScroll);
        window.addEventListener('scroll', handleScroll); 

        if (timelineItems.length > 0) {
            if (runnerEmoji && (runnerEmoji.innerHTML.trim() === '' || runnerEmoji.innerHTML.trim() === '游끢')) {
                runnerEmoji.innerHTML = '涌'; 
            }
            setTimeout(() => {
                requestAnimationFrame(updateActiveState);
                if (!animationFrameId) { 
                    animateTracerLoop();
                }
            }, 100);
        }

        window.addEventListener('resize', () => {
            if (timelineItems.length > 0) {
                requestAnimationFrame(updateActiveState);
            }
        });
    })();
    </script>


    <!-- SCRIPT PRINCIPAL DE LA P츼GINA -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lenis = new Lenis();
            function raf(time) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
            requestAnimationFrame(raf);

            gsap.registerPlugin(ScrollTrigger);
            lenis.on('scroll', ScrollTrigger.update);
            gsap.ticker.add((time) => {
                lenis.raf(time * 1000);
            });
            gsap.ticker.lagSmoothing(0);

            const menuTrigger = document.querySelector('.menu-trigger');
            const menuOverlay = document.querySelector('.menu-overlay');
            const menuCloseBtn = document.querySelector('.menu-close-btn');
            function toggleMenu() {
                const isActive = document.body.classList.toggle('menu-is-open');
                menuOverlay.classList.toggle('is-open');
                menuTrigger.classList.toggle('is-active');
                if (isActive) {
                    lenis.stop();
                } else {
                    lenis.start();
                }
            }
            if (menuTrigger) menuTrigger.addEventListener('click', toggleMenu);
            if (menuCloseBtn) menuCloseBtn.addEventListener('click', toggleMenu);
            
            document.querySelectorAll('.menu-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (menuOverlay.classList.contains('is-open')) {
                        toggleMenu();
                    }
                    setTimeout(() => { 
                        const targetId = link.getAttribute('href');
                        if (targetId === '#page-top') {
                            lenis.scrollTo(0, { duration: 1.5 });
                        } else {
                            lenis.scrollTo(targetId, { offset: -80 });
                        }
                    }, 600); 
                });
            });

            document.querySelector('.top-link').addEventListener('click', (e) => {
                e.preventDefault();
                lenis.scrollTo(0, { duration: 1.5, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)) });
            });

            const mm = gsap.matchMedia();

            mm.add("(min-width: 769px)", () => {
                const tl_desktop = gsap.timeline({
                    scrollTrigger: {
                        trigger: ".sequence-container",
                        start: "top top",
                        end: "+=150%",
                        scrub: 1.5,
                        pin: ".sticky-element",
                    }
                });
                tl_desktop.to(".knockout-text-layer", { scale: 15, ease: "none" }, 0)
                  .from(".background-image", { scale: 1.2, ease: "none" }, 0)
                  .to(".knockout-text-layer", { opacity: 0, ease: "power1.in" }, ">-0.4");
            });
            
            const scrollDownLink = document.querySelector('.scroll-down-link');
            if(scrollDownLink) {
                scrollDownLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    lenis.scrollTo('#evolucion', { offset: -20 });
                });
            }

            const scrollDownLink2 = document.querySelector('.scroll-down-link-2');
            if(scrollDownLink2) {
                scrollDownLink2.addEventListener('click', (e) => {
                    e.preventDefault();
                    lenis.scrollTo('#proceso-data-analisis', { offset: -80 });
                });
            }
            
            // --- L칍GICA DE LA GALER칈A CON NAVEGACI칍N EN MODAL ---
            const mainImageContainer = document.querySelector('.gallery-main-image');
            const mainImage = document.getElementById('main-gallery-image');
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');
            const imageModal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            const modalCloseBtn = document.querySelector('.modal-close-btn');
            const modalPrevBtn = document.querySelector('.modal-prev');
            const modalNextBtn = document.querySelector('.modal-next');
            let currentIndex = 0;
            let galleryInterval;

            if (mainImage && thumbnails.length > 0) {
                const showSlide = (index) => {
                    if (index >= thumbnails.length || index < 0) return;
                    currentIndex = index;
                    thumbnails.forEach(t => t.classList.remove('active'));
                    thumbnails[currentIndex].classList.add('active');

                    const newSrc = thumbnails[currentIndex].querySelector('img').src;
                    mainImage.style.opacity = 0;
                    setTimeout(() => {
                        mainImage.src = newSrc;
                        mainImage.style.opacity = 1;
                    }, 300);
                };

                const nextSlide = () => {
                    const nextIndex = (currentIndex + 1) % thumbnails.length;
                    showSlide(nextIndex);
                };
                
                const startSlideshow = () => {
                    clearInterval(galleryInterval);
                    galleryInterval = setInterval(nextSlide, 4000); 
                };

                thumbnails.forEach((thumb, index) => {
                    thumb.addEventListener('click', function() {
                        showSlide(index);
                        startSlideshow(); 
                    });
                });
                
                startSlideshow();

                // L칩gica del Lightbox/Modal
                if (imageModal && modalImage && modalCloseBtn && modalPrevBtn && modalNextBtn) {
                    const openModal = () => {
                        modalImage.src = mainImage.src; // Abre la imagen que est치 actualmente en el carrusel
                        imageModal.style.display = 'flex';
                        lenis.stop();
                    };

                    const closeModal = () => {
                        imageModal.style.display = 'none';
                        lenis.start();
                    };

                    // Funci칩n para cambiar de imagen dentro del modal
                    const changeModalImage = (direction) => {
                        currentIndex += direction;
                        // Permite que la galer칤a sea c칤clica
                        if (currentIndex >= thumbnails.length) {
                            currentIndex = 0;
                        } else if (currentIndex < 0) {
                            currentIndex = thumbnails.length - 1;
                        }
                        // Actualiza la imagen del modal y la del carrusel principal
                        const newSrc = thumbnails[currentIndex].querySelector('img').src;
                        modalImage.src = newSrc;
                        mainImage.src = newSrc; // Actualiza tambi칠n la imagen principal
                        thumbnails.forEach(t => t.classList.remove('active'));
                        thumbnails[currentIndex].classList.add('active');
                    };

                    mainImageContainer.addEventListener('click', openModal);
                    modalCloseBtn.addEventListener('click', closeModal);
                    
                    // Cierra el modal si se hace clic fuera de la imagen
                    imageModal.addEventListener('click', (e) => {
                        if (e.target === imageModal) {
                            closeModal();
                        }
                    });

                    // Event listeners para los botones de navegaci칩n del modal
                    modalPrevBtn.addEventListener('click', () => changeModalImage(-1));
                    modalNextBtn.addEventListener('click', () => changeModalImage(1));

                    // Event listener para la navegaci칩n con teclado
                    document.addEventListener('keydown', (e) => {
                        if (imageModal.style.display === 'flex') {
                            if (e.key === 'ArrowLeft') {
                                changeModalImage(-1);
                            } else if (e.key === 'ArrowRight') {
                                changeModalImage(1);
                            } else if (e.key === 'Escape') {
                                closeModal();
                            }
                        }
                    });
                }
            }
            
            document.addEventListener('click', (event) => {
                if (menuOverlay.classList.contains('is-open')) {
                    const isClickInsideMenu = menuOverlay.contains(event.target);
                    const isClickOnTrigger = menuTrigger.contains(event.target);
                    if (!isClickInsideMenu && !isClickOnTrigger) {
                        toggleMenu();
                    }
                }
            });

            // Script para la nueva secci칩n "Proceso Data An치lisis"
            const stepsData = [
                { id: 1, phase: 1, content: `<h3 class="text-xl font-bold mb-3">Paso 1: Definici칩n de Necesidades y Objetivos</h3><p class="mb-4">Esta es la piedra angular. Antes de analizar cualquier dato, debemos tener absoluta claridad sobre qu칠 preguntas de negocio queremos responder y qu칠 metas buscamos alcanzar.</p><ul class="list-disc space-y-2"><li><strong>Identificar Necesidades:</strong> Entender los desaf칤os actuales y las decisiones clave.</li><li><strong>Establecer <span class="tooltip-container">KPIs<span class="tooltip-text">Un <strong>KPI</strong> (Key Performance Indicator) es una m칠trica medible para evaluar el 칠xito.</span></span>:</strong> Definir m칠tricas espec칤ficas y medibles.</li><li><strong>Definir Objetivos Cuantificables:</strong> Traducir las necesidades en metas num칠ricas.</li></ul>`},
                { id: 2, phase: 1, content: `<h3 class="text-xl font-bold mb-3">Paso 2: Identificaci칩n y Recopilaci칩n de Datos</h3><p class="mb-4">Con los objetivos definidos, el siguiente paso es actuar como detectives de datos: encontrar d칩nde reside la informaci칩n valiosa y establecer mecanismos para recopilarla.</p><ul class="list-disc space-y-2"><li><strong>Fuentes Internas:</strong> Bases de datos (CRM, ERP), registros de ventas, etc.</li><li><strong>Fuentes Externas:</strong> Datos de mercado, redes sociales.</li><li><strong>Tipos de Datos:</strong> <span class="tooltip-container">Estructurados<span class="tooltip-text"><strong>Datos estructurados:</strong> Formato organizado, como tablas.</span></span> y <span class="tooltip-container">No Estructurados<span class="tooltip-text"><strong>Datos no estructurados:</strong> Sin formato predefinido, como emails o im치genes.</span></span>.</li></ul>`},
                { id: 3, phase: 1, content: `<h3 class="text-xl font-bold mb-3">Paso 3: Limpieza y Preparaci칩n de Datos</h3><p class="mb-4">Los datos en su estado natural suelen estar incompletos o con errores. Decisiones basadas en datos "sucios" son peligrosas, por lo que este paso garantiza la fiabilidad.</p><ul class="list-disc space-y-2"><li><strong><span class="tooltip-container">Limpieza de Datos<span class="tooltip-text">Proceso de detectar y corregir registros incorrectos.</span></span>:</strong> Corregir errores, inconsistencias y duplicados.</li><li><strong>Transformaci칩n de Datos:</strong> Combinar fuentes y crear nuevas variables.</li></ul>`},
                { id: 4, phase: 1, content: `<h3 class="text-xl font-bold mb-3">Paso 4: An치lisis y Visualizaci칩n con BI</h3><p class="mb-4">Con datos limpios, transformamos la informaci칩n en conocimiento visual y accionable, respondiendo a la pregunta: "쯈u칠 est치 sucediendo en nuestro negocio?".</p><ul class="list-disc space-y-2"><li><strong>An치lisis Exploratorio:</strong> Investigar los datos para descubrir patrones y tendencias.</li><li><strong>Generaci칩n de <span class="tooltip-container">Dashboards<span class="tooltip-text">Resumen visual y en tiempo real de los KPIs m치s importantes.</span></span> y <span class="tooltip-container">BI<span class="tooltip-text">Conjunto de estrategias y herramientas para el an치lisis de datos.</span></span>:</strong> Crear visualizaciones interactivas.</li></ul>`},
                { id: 5, phase: 2, content: `<h3 class="text-xl font-bold mb-3">Paso 5: Implementaci칩n de Machine Learning</h3><p class="mb-4">Una vez que entendemos lo que ha pasado, podemos empezar a predecir lo que podr칤a pasar, utilizando algoritmos para descubrir patrones complejos.</p><ul class="list-disc space-y-2"><li><strong>Desarrollo de Modelos:</strong> Usar <span class="tooltip-container">Machine Learning<span class="tooltip-text">Rama de la IA que permite a las m치quinas aprender de los datos para hacer predicciones.</span></span> y <span class="tooltip-container">Deep Learning<span class="tooltip-text">Subcampo del ML que usa redes neuronales complejas.</span></span> para construir modelos predictivos.</li></ul>`},
                { id: 6, phase: 2, content: `<h3 class="text-xl font-bold mb-3">Paso 6: Aplicaci칩n y Mejora Continua</h3><p class="mb-4">Un modelo no tiene valor si se queda en una presentaci칩n. El objetivo es integrar estos conocimientos en los procesos de negocio para generar un impacto real y medible. Este es un ciclo que nunca termina.</p><ul class="list-disc space-y-2"><li><strong>Inyecci칩n en el Proceso:</strong> Usar predicciones para optimizar log칤stica y personalizar campa침as.</li><li><strong>Monitoreo y Refinamiento:</strong> Reentrenar y mejorar los modelos constantemente.</li></ul>`}
            ];

            const stepRows = document.querySelectorAll('#proceso-data-analisis .step-row');
            const totalSteps = stepRows.length;
            let revealInterval;
            let restartTimeout;
            let userInteracted = false;

            function setActiveStep(stepId) {
                stepRows.forEach(row => {
                    const card = row.querySelector('.step-card');
                    const currentStepId = parseInt(card.dataset.stepId);
                    const stepData = stepsData.find(s => s.id === currentStepId);
                    const activeBorderColor = stepData.phase === 1 ? 'var(--color-primary)' : 'var(--color-secondary)';
                    
                    if (currentStepId === stepId) {
                        card.classList.add('active');
                        card.style.borderColor = activeBorderColor;
                    } else {
                        card.classList.remove('active');
                        card.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    }
                });
            }

            function startAnimationCycle() {
                if (userInteracted) return; 

                // Clear any existing timers
                clearInterval(revealInterval);
                clearTimeout(restartTimeout);

                // Hide all steps initially
                stepRows.forEach(row => {
                    row.style.opacity = '0';
                    const contentBlock = document.getElementById(`step-content-block-${row.dataset.step}`);
                    contentBlock.innerHTML = '';
                    row.querySelector('.step-card').classList.remove('active');
                });

                let currentStepIndex = 0;

                revealInterval = setInterval(() => {
                    if (userInteracted) {
                        clearInterval(revealInterval);
                        return;
                    }
                    if (currentStepIndex < totalSteps) {
                        const row = stepRows[currentStepIndex];
                        const stepId = parseInt(row.dataset.step);
                        const stepData = stepsData.find(s => s.id === stepId);
                        
                        row.style.opacity = '1';
                        const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                        contentBlock.innerHTML = stepData.content;
                        setActiveStep(stepId);

                        currentStepIndex++;
                    } else {
                        clearInterval(revealInterval);
                        // After the last step, all content stays visible. Pause for 4 minutes.
                        restartTimeout = setTimeout(startAnimationCycle, 240000); // 4 minutes
                    }
                }, 3000); 
            }

            document.querySelectorAll('#proceso-data-analisis .step-card').forEach(card => {
                card.addEventListener('click', function() {
                    userInteracted = true;
                    clearInterval(revealInterval);
                    clearTimeout(restartTimeout);

                    // Show all rows
                    stepRows.forEach(row => {
                        row.style.opacity = '1';
                        const stepId = parseInt(row.dataset.step);
                        const contentBlock = document.getElementById(`step-content-block-${stepId}`);
                        if (!contentBlock.innerHTML) {
                             const stepData = stepsData.find(s => s.id === stepId);
                             contentBlock.innerHTML = stepData.content;
                        }
                    });

                    const clickedStepId = parseInt(this.dataset.stepId);
                    setActiveStep(clickedStepId);
                });
            });
            startAnimationCycle();
        });
    </script>
</body>
</html>
